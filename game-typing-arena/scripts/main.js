"use strict";function AnimationsLoop(){var t=this;this.array=[],this.paused=!1;function a(i){t.array.map(function(a){a(i)}),t.paused||requestAnimationFrame(a)}this.play=function(){t.paused=!1,requestAnimationFrame(a)},this.pause=function(){t.paused=!0},this.push=function(a){t.array.push(a)}}
"use strict";function AI(n){var e=this;this.time=1600,this.interval=setInterval(this.action,this.time),this.setTime=function(t){return clearInterval(e.interval),e.time=400<t?t:400,e.time<800?n.setSkin("man"):e.time<1e3&&800<=e.time?n.setSkin("niga"):e.time<1400&&1e3<=e.time?n.setSkin("boy"):e.time<1800&&1400<=e.time?n.setSkin("girl"):n.setSkin("zombie"),e.interval=setInterval(e.action,e.time),e},this.action=function(){for(var t in gameObjects)if(gameObjects[t]!==n){var e=gameObjects[t].state.positionX-n.state.positionX;if(Math.abs(e)<=200)if(0===Math.round(Math.random()))s(0);else{var i=Math.floor(3*Math.random()+1);s(i)}else{var a=Math.floor(3*Math.random()+1);s(a)}}};var s=function(t){switch(t){case 0:n.runAction("hit");break;case 1:n.runAction("move",1);break;case 2:n.runAction("move",-1);break;case 3:n.runAction("jump")}}}
"use strict";function Hero(s){var o=this,n=[],a=s.querySelector(".hero__direction"),i=s.querySelector(".ui"),c=document.createElement("div");c.className="hero__health",s.appendChild(c),this.state={action:!1,nextAction:!1,health:100,damage:0,pose:null,direction:1,directionY:1,positionX:0,positionY:0,speedX:0,boostX:0,speedY:0,boostY:0},this.setPose=function(t){return o.state.pose&&requestAnimationFrame(function(){s.classList.remove("hero_"+o.state.pose)}),t&&(o.state.pose=t,requestAnimationFrame(function(){s.classList.add("hero_"+t)})),o},this.unsetPose=function(t){return o.state.pose=null,requestAnimationFrame(function(){s.classList.remove("hero_"+t)}),o},this.setSkin=function(t){return s.classList.remove("hero_"+o.state.skin),(o.state.skin=t)&&s.classList.add("hero_"+t),o},this.runAction=function(t,e){if(o.state.health<=0||animationsLoop.paused)return o;if(1!==e&&-1!==e||e!==o.state.direction&&(o.state.direction=e,o.state.speedX=0),-1!==n.indexOf(t))return o.state.nextAction=[t,e],o;var s=!!r[t]&&r[t];if(!s)return o;n.push(t);var a=0;return s.map(function(t){setTimeout(t.action,a),a+=t.duration?t.duration:0}),setTimeout(function(){n.splice(n.indexOf(t,1)),o.state.nextAction&&(o.runAction(o.state.nextAction[0],o.state.nextAction[1]),o.state.nextAction=!1)},a),o};var r={jump:[{name:"jump-start",duration:1500,action:function(){0<!o.state.positionY&&(o.state.speedY=60,o.state.boostX=40)}}],down:[{name:"down-start",duration:500,action:function(){o.setPose("down")}},{name:"down-end",action:function(){o.unsetPose("down")}}],move:[{name:"Step1",duration:300,action:function(){o.state.boostX=35,o.state.pose||o.setPose("step-1")}},{name:"Step2",duration:300,action:function(){o.unsetPose("step-1"),o.state.pose||o.setPose("step-2")}},{name:"stop",action:function(){o.unsetPose("step-2")}}],damage:[{name:"takeDamageStart",duration:300,action:function(){o.setPose("damage"),o.state.health-=o.state.damage,o.state.damage=0}},{name:"takeDamageEnd",action:function(){o.unsetPose("damage"),o.state.health<=0&&setTimeout(setDefault,3e3)}}],hit:[{name:"hit1",duration:300,action:function(){o.setPose("hit-1")}},{name:"hit2",duration:300,action:function(){o.unsetPose("hit-1"),o.setPose("hit-2");var t=!1;for(var e in gameObjects)if(gameObjects[e]!==o){var s=gameObjects[e].state.positionX-o.state.positionX,a=gameObjects[e].state.positionY-o.state.positionY;Math.abs(s)<=200&&Math.abs(a)<100&&(t||(0<s?(o.state.direction=1,gameObjects[e].state.direction=-1):(o.state.direction=-1,gameObjects[e].state.direction=1),t=!0),o.state.direction+gameObjects[e].state.direction===0&&0<s*o.state.direction&&(gameObjects[e].state.speedX=-50,gameObjects[e].state.damage+=10))}}},{name:"hitEnd",action:function(){o.unsetPose("hit-2")}}]};return animationsLoop.push(function(){var t=physics(o.state.positionX,o.state.boostX,o.state.speedX,o.state.direction,arena.xMax,arena.xMin);0<o.state.damage&&o.runAction("damage"),o.state.health<=0?(o.state.health=0,c.style.color="#222",o.setPose("dead"),i.style.display="none"):(o.unsetPose("dead"),i.style.display=""),0<o.state.health&&o.state.health<=30?c.style.color="#f00":30<o.state.health&&o.state.health<=60?c.style.color="#ff0":60<o.state.health&&(c.style.color="#0f0"),o.state.positionX=t.position,o.state.boostX=t.boost,o.state.speedX=t.speed,o.state.direction=t.direction;var e=physics(o.state.positionY,o.state.boostY,o.state.speedY,o.state.directionY,arena.yMax,arena.yMin);o.state.positionY=e.position,o.state.boostY=e.boost,o.state.speedY=e.speed,o.state.directionY=e.direction,0===o.state.speedY&&0<o.state.positionY&&(o.state.directionY=-1),-1===o.state.directionY&&(o.state.speedY+=3),o.state.positionY<=0&&o.state.speedY<80&&(o.state.boostY=0,o.state.speedY=0,o.state.positionY=0,o.state.directionY=1,"jump"===o.state.pose&&(o.setPose("landed"),setTimeout(function(){o.unsetPose("landed"),o.unsetPose("jump")},300))),0<o.state.speedY?o.state.pose||o.setPose("jump"):o.unsetPose("jump"),s.style.transform="translate(".concat(o.state.positionX,"%, ").concat(-o.state.positionY,"%)"),a.style.transform="scaleX(".concat(o.state.direction,")"),c.innerText=o.state.health}),this}
"use strict";function physics(s,t,a,i,b,h){return a=Math.abs(a)<1?0:a,0<(t=t<=0?0:t)?(t-=1+Math.abs(t)/100,a+=1+Math.abs(t)/100):0!==a&&0<a?a-=1+Math.abs(a)/100:0!==a&&a<0&&(a+=1+Math.abs(a)/100),b<(s+=a/10*i)?i=0<a?-1:1:s<h&&(i=0<a?1:-1),{position:s,boost:t,speed:a,direction:i}}
"use strict";function Ui(){var o=this,n=0,i=-1;this.elements=[],this.makePhrase=function(e){for(var i="",l="abcdefghijklmnopqrstuvwxyz",m=l.length,t=function(t){var s=l.charAt(Math.floor(Math.random()*m)),n=!1;0===t&&o.elements.map(function(e){e.symbols[0]===s&&(t=-1,n=!0)}),n||(i+=s),a=t},a=0;a<e;a++)t(a);return i};for(var t,e=document.querySelectorAll(".ui__element"),s=0;s<e.length;s++){this.elements[s]=new m(e[s]);var l=4;config.lengthPhrasesForActions[this.elements[s].action]&&(l=config.lengthPhrasesForActions[this.elements[s].action]),this.elements[s].setText(this.makePhrase(l))}function m(e){var i=this;return this.elem=e,this.text="",this.action=e.dataset.action,this.direction=e.dataset.direction,this.icon=e.dataset.icon,this.symbols=[],this.elemSymbols=[],this.elemText=document.createElement("div"),this.elemText.classList.add("ui__text"),this.elem.appendChild(this.elemText),this.elemUiIcon=document.createElement("div"),this.elemUiIcon.classList.add("ui__icon"),this.elem.appendChild(this.elemUiIcon),this.elemIcon=document.createElement("div"),this.elemIcon.classList.add("icon"),this.elemIcon.classList.add("icon_"+this.icon),this.elemUiIcon.appendChild(this.elemIcon),this.setText=function(e){i.text=e,i.elemText.innerHTML="";var n="fadeIn";i.text.split("").map(function(e,t){var s=document.createElement("span");e=" "===e?"&nbsp;":e,i.symbols[t]=e,s.innerHTML=e,s.className="ui__symbol "+n,s.style.display="inline-block",s.style.animationDelay=100*t+"ms",i.elemSymbols[t]=s,i.elemText.appendChild(s),setTimeout(function(){s.classList.remove(n)},100*(t+1))})},this}this.found=function(s){var e=!1;return clearTimeout(t),t=setTimeout(function(){o.found(!1)},1200),i<0?(o.elements.map(function(e,t){e.symbols[n]===s?(e.elemSymbols[n].classList.add("fadeOutDown"),e.elemText.style.transform="scale(1.5)",i=t,performance.now()):e.elem.style.display="none"}),n++):o.elements[i].symbols[n]===s?(o.elements[i].elemSymbols[n].classList.remove("fadeIn"),o.elements[i].elemSymbols[n].classList.add("fadeOutDown"),n++):(o.elements[i].setText(o.makePhrase(o.elements[i].text.length)),i=-1,n=0),0<=i&&o.elements[i].symbols.length===n?(o.elements[i].setText(o.makePhrase(o.elements[i].text.length)),gameObjects.player.runAction(o.elements[i].action,+o.elements[i].direction),i=-1,e=!(n=0)):0<=i&&o.elements[i].elemSymbols[n].classList.add("ui__symbol_selected"),i<0&&(o.elements.map(function(e){e.elem.style.display="",e.elemText.style.transform=""}),i=-1,n=0,!!e)}}
"use strict";function funText(t,a){var n=t.innerText;t.innerHTML="",n.split("").map(function(n,e){var i=document.createElement("span");n=" "===n?"&nbsp;":n,i.innerHTML=n,i.className=a,i.style.display="inline-block",i.style.animationDelay=100*e+"ms",t.appendChild(i)})}
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var activeDrawsList=[],showFrameRate=!1;function animate(t){var i="number"==typeof(t="object"==_typeof(t)?t:{}).duration?t.duration:1e3,e="number"==typeof t.delay?t.delay:0,n="number"==typeof t.from?t.from:1,o="number"==typeof t.to?t.to:100,f="function"==typeof t.timing?t.timing:linear,c="function"==typeof t.draw?t.draw:function(t){console.log(100*t)},s="function"==typeof t.before?t.before:function(){},m="function"==typeof t.after?t.after:function(){},p=n/100,y=o/100;setTimeout(function(){for(var a=performance.now(),u=a,t=activeDrawsList.length-1;0<=t;t--)if(activeDrawsList[t]===c)return!1;activeDrawsList.push(c);requestAnimationFrame(function t(e){s&&(s(),s=!1);var n=(e-a)/i;if(1<n&&(n=1),p<y)var o=(n+=p)<y;else o=y<(n=-(n-p));var r=f(n);c(r),o?(requestAnimationFrame(t),showFrameRate&&(console.log(frameRate(u,e),Math.round(100*n)),u=e)):(activeDrawsList.splice(activeDrawsList.indexOf(c),1),m&&m())})},e)}function frameRate(t,e){return Math.round(1e3/(e-t))}function zone(t,e,n,o){if(n*=100,o*=100,(e*=100)<=(t*=100)&&t<=n){var r=(t-e)/(n-e);return o&&o(r),r}return t<=e?0:n<=t?1:void 0}function makeEaseOut(e){return function(t){return 1-e(1-t)}}function makeEaseInOut(e){return function(t){return t<.5?e(2*t)/2:(2-e(2*(1-t)))/2}}function linear(t){return t}function quad(t){return Math.pow(t,2)}var quadEaseOut=makeEaseOut(quad);function circ(t){return 1-Math.sin(Math.acos(t))}var circEaseOut=makeEaseOut(circ);function back(t,e){return Math.pow(e,2)*((t+1)*e-t)}var backEaseOut=makeEaseOut(back);function bounce(t){for(var e=0,n=1;;e+=n,n/=2)if((7-4*e)/11<=t)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(n,2)}var bounceEaseOut=makeEaseOut(bounce);function elastic(t,e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}var elasticEaseOut=makeEaseOut(elastic);
"use strict";function ready(e){document.addEventListener("DOMContentLoaded",e)}function addEvent(e,t,n){null!=e&&void 0!==e&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)}function compareRandom(e,t){return Math.random()-.5}function getDocument(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=(new DOMParser).parseFromString(this.responseText,"text/html");t(e)}},n.send(null)}function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}!function(e,t,n){n=n||window;var o=!1;n.addEventListener(e,function(){o||(o=!0,requestAnimationFrame(function(){n.dispatchEvent(new CustomEvent(t)),o=!1}))})}("resize","optimizedResize");
"use strict";var breakpoint={small:767,medium:992,large:1200};function respondTo(i,n,e,t){if(i>=window.innerWidth){var r=!0;e&&requestAnimationFrame(n)}else r=!1;t&&window.addEventListener("optimizedResize",function(){if(!r&&(r=!0,i>=window.innerWidth))return setTimeout(function(){requestAnimationFrame(n)},100),!0;i<=window.innerWidth&&(r=!1)})}function respondFrom(i,n,e,t){if(i<=window.innerWidth){var r=!0;e&&requestAnimationFrame(n)}else r=!1;t&&window.addEventListener("optimizedResize",function(){if(!r&&(r=!0,i<=window.innerWidth))return setTimeout(function(){requestAnimationFrame(n)},100),!0;i>=window.innerWidth&&(r=!1)})}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvQW5pbWF0aW9uc0xvb3AuanMiLCJjb21wb25lbnRzL2FpLmpzIiwiY29tcG9uZW50cy9oZXJvLmpzIiwiY29tcG9uZW50cy9waHlzaWNzLmpzIiwiY29tcG9uZW50cy91aS5qcyIsImFuaW1hdGlvbnMvZnVuVGV4dC5qcyIsImhlbHBlcnMvYW5pbWF0ZS5qcyIsImhlbHBlcnMvb3RoZXJzLmpzIiwiaGVscGVycy9yZXNwb25kLmpzIl0sIm5hbWVzIjpbIkFuaW1hdGlvbnNMb29wIiwiX3RoaXMiLCJ0aGlzIiwiYXJyYXkiLCJsb29wIiwidGltZSIsIm1hcCIsImFuaW1hdGUiLCJwYXVzZWQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJwbGF5IiwicHVzaCIsImVsZW0iLCJwYXVzZSIsIkFJIiwiaGVybyIsInNldEludGVydmFsIiwiYWN0aW9uIiwic2V0VGltZSIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInNldFNraW4iLCJrZXkiLCJnYW1lT2JqZWN0cyIsImRpc3RhbmNlIiwic3RhdGUiLCJwb3NpdGlvblgiLCJhYnMiLCJzd2l0Y2hBY3Rpb24iLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJhY3Rpb25JbmRleCIsImluZGV4IiwicnVuQWN0aW9uIiwiSGVybyIsImVsZW1IZXJvIiwiYWN0aXZlQWN0aW9ucyIsInF1ZXJ5U2VsZWN0b3IiLCJlbGVtVWkiLCJlbGVtRGlyZWN0aW9uIiwiZWxlbVVpSGVhbHRoIiwiZG9jdW1lbnQiLCJhcHBlbmRDaGlsZCIsIm5leHRBY3Rpb24iLCJoZWFsdGgiLCJkYW1hZ2UiLCJkaXJlY3Rpb24iLCJkaXJlY3Rpb25ZIiwicG9zaXRpb25ZIiwic3BlZWRYIiwiYm9vc3RYIiwic3BlZWRZIiwic2V0UG9zZSIsInBvc2UiLCJyZW1vdmUiLCJhZGQiLCJ1bnNldFBvc2UiLCJjbGFzc0xpc3QiLCJza2luIiwiYWN0aW9uTmFtZSIsImFuaW1hdGlvbnNMb29wIiwiaW5kZXhPZiIsImFjdGlvbnMiLCJkZWxheSIsImFjdGlvblN0ZXAiLCJzZXRUaW1lb3V0IiwiZHVyYXRpb24iLCJzcGxpY2UiLCJqdW1wIiwibmFtZSIsInNldERlZmF1bHQiLCJkaXN0YW5jZVkiLCJjaGFuZ2VkRGlyZWN0aW9uIiwibmV4dFBvc2l0aW9uc1giLCJwaHlzaWNzIiwic3R5bGUiLCJkaXNwbGF5IiwiYXJlbmEiLCJ4TWF4IiwieE1pbiIsImNvbG9yIiwibmV4dFBvc2l0aW9uc1kiLCJwb3NpdGlvbiIsImJvb3N0Iiwic3BlZWQiLCJib29zdFkiLCJ5TWF4IiwidHJhbnNmb3JtIiwiaW5uZXJUZXh0IiwiY29uY2F0IiwicG9zTWF4IiwicG9zTWluIiwiVWkiLCJjaGFyQ291bnRlciIsImZvdW5kIiwiZWxlbWVudHMiLCJsZW5ndGgiLCJjaGFyYWN0ZXJzIiwiY2hhcmFjdGVyc0xlbmd0aCIsIl9sb29wIiwiX2kiLCJjaGFyQXQiLCJza2lwIiwiaSIsIm5ld0NoYXIiLCJlbGVtZW50Iiwic3ltYm9scyIsInJlc3VsdCIsImVsZW1zIiwicXVlcnlTZWxlY3RvckFsbCIsIlVpRWxlbWVudCIsImNvbmZpZyIsImxlbmd0aFBocmFzZXNGb3JBY3Rpb25zIiwic2V0VGV4dCIsIm1ha2VQaHJhc2UiLCJfdGhpczIiLCJ0ZXh0IiwiZGF0YXNldCIsInVpRWxlbWVudCIsImVsZW1UZXh0IiwiZWxlbVN5bWJvbHMiLCJjcmVhdGVFbGVtZW50IiwiYWN0aW9uUGxheWVkIiwiZWxlbVVpSWNvbiIsImVsZW1JY29uIiwiaWNvbiIsImZhZGVDbGFzcyIsInN5bWJvbCIsImFuaW1hdGlvbkRlbGF5Iiwic3BhbiIsImNsZWFyVGltZW91dCIsInRpbWVyRm91bmQiLCJwZXJmb3JtYW5jZSIsIm5vdyIsInRpbWVTdGFydCIsInBsYXllciIsImZ1blRleHQiLCJhbmltYXRlQ2xhc3MiLCJpbm5lckhUTUwiLCJzcGxpdCIsImNsYXNzTmFtZSIsImFjdGl2ZURyYXdzTGlzdCIsInNob3dGcmFtZVJhdGUiLCJvcHRpb25zIiwiX3R5cGVvZiIsImZyb20iLCJ0byIsImxpbmVhciIsImRyYXciLCJwcm9ncmVzcyIsImNvbnNvbGUiLCJsb2ciLCJiZWZvcmUiLCJhZnRlciIsInN0YXJ0IiwiZnJhY3Rpb25Gcm9tIiwiYW5pbWF0aW9uSW5kZXgiLCJ0aW1lRnJhY3Rpb24iLCJmcmFjdGlvblRvIiwidGltaW5nIiwidGVybWluYXRpb25Db25kaXRpb24iLCJmcmFtZVJhdGUiLCJ0aW1lTGFzdCIsInJvdW5kIiwidGltZU5vdyIsImN1cnJlbnQiLCJtYWtlRWFzZU91dCIsIm1ha2VFYXNlSW5PdXQiLCJxdWFkIiwicXVhZEVhc2VPdXQiLCJzaW4iLCJhY29zIiwiY2lyY0Vhc2VPdXQiLCJiYWNrIiwieCIsInBvdyIsImJhY2tFYXNlT3V0IiwiYm91bmNlIiwiYSIsImIiLCJib3VuY2VFYXNlT3V0IiwiZWxhc3RpYyIsImNvcyIsIlBJIiwicmVhZHkiLCJsaXN0ZW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudCIsIm9iamVjdCIsInR5cGUiLCJhdHRhY2hFdmVudCIsImNvbXBhcmVSYW5kb20iLCJnZXREb2N1bWVudCIsInVybCIsImNhbGxiYWNrIiwiaHR0cCIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJkb2MiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJyZXNwb25zZVRleHQiLCJzZW5kIiwiZ2V0Q29va2llIiwibWF0Y2hlcyIsInJlcGxhY2UiLCJkZWNvZGVVUklDb21wb25lbnQiLCJ1bmRlZmluZWQiLCJvYmoiLCJ3aW5kb3ciLCJydW5uaW5nIiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwiYnJlYWtwb2ludCIsInNtYWxsIiwibGFyZ2UiLCJyZXNwb25kVG8iLCJydW5XaGVuQ2FsbGVkIiwiaW5uZXJXaWR0aCIsImFjdGl2ZSIsInJlc3BvbmRGcm9tIl0sIm1hcHBpbmdzIjoiYUFBQSxTQUFTQSxpQkFBaUIsSUFBQUMsRUFBQUMsS0FD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QWlCMEIsT0FBQVMsWUFLRixPQUhMNUosV0FBVCxXQUlRekQsc0JBQXNCMEwsSUFIaEIsTUFFQyxFQUdYc0IsR0FBQUosT0FBQVMsYUFBQUMsR0FBQSxLQUlYLFNBWkRDLFlBQUFQLEVBQUF0QixFQUFBMEIsRUFBQWpDLEdBYUgsR0FBQTZCLEdBQUFKLE9BQUFTLFdBQUEsQ0FDSixJQUFBQyxHQUFBLEVBS1dGLEdBSEhHLHNCQUF3QjdCLFFBT3JCNEIsR0FBUyxFQUZabkMsR0FKTHlCLE9BS08xQixpQkFBQSxrQkFBQSxXQUNDb0MsSUFBU0EsSUFDaEJBLEdBQUEsRUFNZU4sR0FBY0osT0FBT1MsWUFLckIsT0FSTG5DLFdBQWlCLFdBQ1BsTCxzQkFBQTBMLElBQ1QsTUFNVyxFQUZIMUwsR0FBQUEsT0FBc0IwTCxhQUF0QjRCLEdBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEFuaW1hdGlvbnNMb29wKCkge1xuICAgIHRoaXMuYXJyYXkgPSBbXTtcbiAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuXG4gICAgY29uc3QgbG9vcCA9ICh0aW1lKSA9PiB7XG4gICAgICAgIHRoaXMuYXJyYXkubWFwKGFuaW1hdGUgPT4ge1xuICAgICAgICAgICAgYW5pbWF0ZSh0aW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghdGhpcy5wYXVzZWQpIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcbiAgICB9O1xuXG4gICAgdGhpcy5wbGF5ID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG4gICAgfTtcblxuICAgIHRoaXMucGF1c2UgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbiAgICB9O1xuXG4gICAgdGhpcy5wdXNoID0gKGVsZW0pID0+IHtcbiAgICAgICAgdGhpcy5hcnJheS5wdXNoKGVsZW0pO1xuICAgIH07XG59IiwiZnVuY3Rpb24gQUkoaGVybykge1xuICAgIHRoaXMudGltZSA9IDE2MDA7XG4gICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMuYWN0aW9uLCB0aGlzLnRpbWUpO1xuXG4gICAgdGhpcy5zZXRUaW1lID0gKHRpbWUpID0+IHtcblxuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuXG4gICAgICAgIHRoaXMudGltZSA9IHRpbWUgPiA0MDAgPyB0aW1lIDogNDAwO1xuICAgICAgICBpZiAodGhpcy50aW1lIDwgODAwKSB7XG4gICAgICAgICAgICBoZXJvLnNldFNraW4oJ21hbicpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGltZSA8IDEwMDAgJiYgdGhpcy50aW1lID49IDgwMCkge1xuICAgICAgICAgICAgaGVyby5zZXRTa2luKCduaWdhJyk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy50aW1lIDwgMTQwMCAmJiB0aGlzLnRpbWUgPj0gMTAwMCkge1xuICAgICAgICAgICAgaGVyby5zZXRTa2luKCdib3knKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRpbWUgPCAxODAwICYmIHRoaXMudGltZSA+PSAxNDAwKSB7XG4gICAgICAgICAgICBoZXJvLnNldFNraW4oJ2dpcmwnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhlcm8uc2V0U2tpbignem9tYmllJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5hY3Rpb24sIHRoaXMudGltZSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdGhpcy5hY3Rpb24gPSAoKSA9PiB7XG4gICAgICAgIGxldCBpO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gZ2FtZU9iamVjdHMpIHtcbiAgICAgICAgICAgIGlmIChnYW1lT2JqZWN0c1trZXldICE9PSBoZXJvKSB7XG4gICAgICAgICAgICAgICAgbGV0IGRpc3RhbmNlID0gZ2FtZU9iamVjdHNba2V5XS5zdGF0ZS5wb3NpdGlvblggLSBoZXJvLnN0YXRlLnBvc2l0aW9uWDtcblxuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhkaXN0YW5jZSkgPD0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2hBY3Rpb24oMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aW9uSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAzICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2hBY3Rpb24oYWN0aW9uSW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGlvbkluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyArIDEpO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2hBY3Rpb24oYWN0aW9uSW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgY29uc3Qgc3dpdGNoQWN0aW9uID0gKGluZGV4KSA9PiB7XG4gICAgICAgIHN3aXRjaCAoaW5kZXgpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBoZXJvLnJ1bkFjdGlvbignaGl0Jyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgaGVyby5ydW5BY3Rpb24oJ21vdmUnLCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBoZXJvLnJ1bkFjdGlvbignbW92ZScsIC0xKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBoZXJvLnJ1bkFjdGlvbignanVtcCcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiZnVuY3Rpb24gSGVybyhlbGVtSGVybykge1xuICAgIGNvbnN0IGFjdGl2ZUFjdGlvbnMgPSBbXTtcbiAgICBjb25zdCBlbGVtRGlyZWN0aW9uID0gZWxlbUhlcm8ucXVlcnlTZWxlY3RvcignLmhlcm9fX2RpcmVjdGlvbicpO1xuICAgIGNvbnN0IGVsZW1VaSA9IGVsZW1IZXJvLnF1ZXJ5U2VsZWN0b3IoJy51aScpO1xuXG5cbiAgICBjb25zdCBlbGVtVWlIZWFsdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBlbGVtVWlIZWFsdGguY2xhc3NOYW1lID0gJ2hlcm9fX2hlYWx0aCc7XG4gICAgZWxlbUhlcm8uYXBwZW5kQ2hpbGQoZWxlbVVpSGVhbHRoKTtcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgIGFjdGlvbjogZmFsc2UsXG4gICAgICAgIG5leHRBY3Rpb246IGZhbHNlLFxuICAgICAgICBoZWFsdGg6IDEwMCxcbiAgICAgICAgZGFtYWdlOiAwLFxuICAgICAgICBwb3NlOiBudWxsLFxuICAgICAgICBkaXJlY3Rpb246IDEsXG4gICAgICAgIGRpcmVjdGlvblk6IDEsXG4gICAgICAgIHBvc2l0aW9uWDogMCxcbiAgICAgICAgcG9zaXRpb25ZOiAwLFxuICAgICAgICBzcGVlZFg6IDAsXG4gICAgICAgIGJvb3N0WDogMCxcbiAgICAgICAgc3BlZWRZOiAwLFxuICAgICAgICBib29zdFk6IDBcbiAgICB9O1xuXG4gICAgdGhpcy5zZXRQb3NlID0gKHBvc2UpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUucG9zZSkge1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgICAgICBlbGVtSGVyby5jbGFzc0xpc3QucmVtb3ZlKCdoZXJvXycgKyB0aGlzLnN0YXRlLnBvc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocG9zZSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5wb3NlID0gcG9zZTtcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgZWxlbUhlcm8uY2xhc3NMaXN0LmFkZCgnaGVyb18nICsgcG9zZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICB0aGlzLnVuc2V0UG9zZSA9IChwb3NlKSA9PiB7XG4gICAgICAgIHRoaXMuc3RhdGUucG9zZSA9IG51bGw7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgZWxlbUhlcm8uY2xhc3NMaXN0LnJlbW92ZSgnaGVyb18nICsgcG9zZSk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzog0JLQvtC30LzQvtC20L3QviDQvdGD0LbQvdC+INCx0YPQtNC10YIg0LLQvtC30LLRgNCw0YnQsNGC0Ywg0L/RgNC10LTRi9C00YPRidGD0Y4g0L/QvtC30YNcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICB0aGlzLnNldFNraW4gPSAoc2tpbikgPT4ge1xuICAgICAgICBlbGVtSGVyby5jbGFzc0xpc3QucmVtb3ZlKCdoZXJvXycgKyB0aGlzLnN0YXRlLnNraW4pO1xuICAgICAgICB0aGlzLnN0YXRlLnNraW4gPSBza2luO1xuICAgICAgICBpZiAoc2tpbikge1xuICAgICAgICAgICAgZWxlbUhlcm8uY2xhc3NMaXN0LmFkZCgnaGVyb18nICsgc2tpbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIHRoaXMucnVuQWN0aW9uID0gKGFjdGlvbk5hbWUsIGRpcmVjdGlvbikgPT4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5oZWFsdGggPD0gMCB8fCBhbmltYXRpb25zTG9vcC5wYXVzZWQpIHJldHVybiB0aGlzO1xuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAxIHx8IGRpcmVjdGlvbiA9PT0gLTEpIHtcbiAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gIT09IHRoaXMuc3RhdGUuZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zcGVlZFggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFjdGl2ZUFjdGlvbnMuaW5kZXhPZiggYWN0aW9uTmFtZSApICE9PSAtMSApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUubmV4dEFjdGlvbiA9IFthY3Rpb25OYW1lLCBkaXJlY3Rpb25dO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhY3Rpb24gPSBhY3Rpb25zW2FjdGlvbk5hbWVdID8gYWN0aW9uc1thY3Rpb25OYW1lXSA6IGZhbHNlO1xuICAgICAgICBpZiAoIWFjdGlvbikgcmV0dXJuIHRoaXM7XG5cbiAgICAgICAgYWN0aXZlQWN0aW9ucy5wdXNoKGFjdGlvbk5hbWUpO1xuXG4gICAgICAgIGxldCBkZWxheSA9IDA7XG4gICAgICAgIGFjdGlvbi5tYXAoKGFjdGlvblN0ZXAsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGFjdGlvblN0ZXAuYWN0aW9uLCBkZWxheSk7XG4gICAgICAgICAgICBkZWxheSArPSBhY3Rpb25TdGVwLmR1cmF0aW9uID8gYWN0aW9uU3RlcC5kdXJhdGlvbiA6IDA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgYWN0aXZlQWN0aW9ucy5zcGxpY2UoYWN0aXZlQWN0aW9ucy5pbmRleE9mKGFjdGlvbk5hbWUsIDEpKTtcblxuICAgICAgICAgICAgaWYodGhpcy5zdGF0ZS5uZXh0QWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ydW5BY3Rpb24odGhpcy5zdGF0ZS5uZXh0QWN0aW9uWzBdLCB0aGlzLnN0YXRlLm5leHRBY3Rpb25bMV0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUubmV4dEFjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBkZWxheSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIGNvbnN0IGFjdGlvbnMgPSB7XG4gICAgICAgICdqdW1wJzogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdqdW1wLXN0YXJ0JyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTUwMCxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnBvc2l0aW9uWSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuc3BlZWRZID0gNjA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmJvb3N0WCA9IDQwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICAnZG93bicgOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ2Rvd24tc3RhcnQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA1MDAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0UG9zZSgnZG93bicpOztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdkb3duLWVuZCcsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5zZXRQb3NlKCdkb3duJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICAnbW92ZScgOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ1N0ZXAxJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzAwLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmJvb3N0WCA9IDM1O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUucG9zZSkgdGhpcy5zZXRQb3NlKCdzdGVwLTEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdTdGVwMicsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDMwMCxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ3N0ZXAtMScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUucG9zZSkgdGhpcy5zZXRQb3NlKCdzdGVwLTInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdzdG9wJyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ3N0ZXAtMicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgJ2RhbWFnZScgOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ3Rha2VEYW1hZ2VTdGFydCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDMwMCxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQb3NlKCdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5oZWFsdGggLT0gdGhpcy5zdGF0ZS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZGFtYWdlID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICd0YWtlRGFtYWdlRW5kJyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5oZWFsdGggPD0gMCkgc2V0VGltZW91dChzZXREZWZhdWx0LCAzMDAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgICdoaXQnIDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdoaXQxJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzAwLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFBvc2UoJ2hpdC0xJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnaGl0MicsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDMwMCxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2hpdC0xJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0UG9zZSgnaGl0LTInKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNoYW5nZWREaXJlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGdhbWVPYmplY3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWVPYmplY3RzW2tleV0gIT09IHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRpc3RhbmNlID0gIGdhbWVPYmplY3RzW2tleV0uc3RhdGUucG9zaXRpb25YIC0gdGhpcy5zdGF0ZS5wb3NpdGlvblg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkaXN0YW5jZVkgPSBnYW1lT2JqZWN0c1trZXldLnN0YXRlLnBvc2l0aW9uWSAtIHRoaXMuc3RhdGUucG9zaXRpb25ZO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhkaXN0YW5jZSkgPD0gMjAwICYmIE1hdGguYWJzKGRpc3RhbmNlWSkgPCAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2hhbmdlZERpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5kaXJlY3Rpb24gPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lT2JqZWN0c1trZXldLnN0YXRlLmRpcmVjdGlvbiA9IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uID0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVPYmplY3RzW2tleV0uc3RhdGUuZGlyZWN0aW9uID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZERpcmVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmRpcmVjdGlvbiArIGdhbWVPYmplY3RzW2tleV0uc3RhdGUuZGlyZWN0aW9uID09PSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgZGlzdGFuY2UgKiB0aGlzLnN0YXRlLmRpcmVjdGlvbiA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lT2JqZWN0c1trZXldLnN0YXRlLnNwZWVkWCA9IC01MDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lT2JqZWN0c1trZXldLnN0YXRlLmRhbWFnZSArPSAxMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnaGl0RW5kJyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2hpdC0yJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdXG4gICAgfTtcblxuICAgIGFuaW1hdGlvbnNMb29wLnB1c2goKHRpbWUpID0+IHtcbiAgICAgICAgbGV0IG5leHRQb3NpdGlvbnNYID0gcGh5c2ljcyhcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucG9zaXRpb25YLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFgsXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNwZWVkWCxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uLFxuICAgICAgICAgICAgYXJlbmEueE1heCxcbiAgICAgICAgICAgIGFyZW5hLnhNaW4pO1xuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmRhbWFnZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucnVuQWN0aW9uKCdkYW1hZ2UnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmhlYWx0aCA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmhlYWx0aCA9IDA7XG4gICAgICAgICAgICBlbGVtVWlIZWFsdGguc3R5bGUuY29sb3IgPSAnIzIyMic7XG4gICAgICAgICAgICB0aGlzLnNldFBvc2UoJ2RlYWQnKTtcbiAgICAgICAgICAgIGVsZW1VaS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2RlYWQnKTtcbiAgICAgICAgICAgICBlbGVtVWkuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaGVhbHRoID4gMCAmJiB0aGlzLnN0YXRlLmhlYWx0aCA8PSAzMCkge1xuICAgICAgICAgICAgZWxlbVVpSGVhbHRoLnN0eWxlLmNvbG9yID0gJyNmMDAnO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUuaGVhbHRoID4gMzAgJiYgIHRoaXMuc3RhdGUuaGVhbHRoIDw9IDYwKSB7XG4gICAgICAgICAgICBlbGVtVWlIZWFsdGguc3R5bGUuY29sb3IgPSAnI2ZmMCc7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZS5oZWFsdGggPiA2MCkge1xuICAgICAgICAgICAgZWxlbVVpSGVhbHRoLnN0eWxlLmNvbG9yID0gJyMwZjAnO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zdGF0ZS5wb3NpdGlvblggPSBuZXh0UG9zaXRpb25zWC5wb3NpdGlvbjtcbiAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFggPSBuZXh0UG9zaXRpb25zWC5ib29zdDtcbiAgICAgICAgdGhpcy5zdGF0ZS5zcGVlZFggPSBuZXh0UG9zaXRpb25zWC5zcGVlZDtcbiAgICAgICAgdGhpcy5zdGF0ZS5kaXJlY3Rpb24gPSBuZXh0UG9zaXRpb25zWC5kaXJlY3Rpb247XG5cbiAgICAgICAgbGV0IG5leHRQb3NpdGlvbnNZID0gcGh5c2ljcyhcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucG9zaXRpb25ZLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFksXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNwZWVkWSxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uWSxcbiAgICAgICAgICAgIGFyZW5hLnlNYXgsXG4gICAgICAgICAgICBhcmVuYS55TWluKTtcblxuICAgICAgICB0aGlzLnN0YXRlLnBvc2l0aW9uWSA9IG5leHRQb3NpdGlvbnNZLnBvc2l0aW9uO1xuICAgICAgICB0aGlzLnN0YXRlLmJvb3N0WSA9IG5leHRQb3NpdGlvbnNZLmJvb3N0O1xuICAgICAgICB0aGlzLnN0YXRlLnNwZWVkWSA9IG5leHRQb3NpdGlvbnNZLnNwZWVkO1xuICAgICAgICB0aGlzLnN0YXRlLmRpcmVjdGlvblkgPSBuZXh0UG9zaXRpb25zWS5kaXJlY3Rpb247XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc3BlZWRZID09PSAwICYmIHRoaXMuc3RhdGUucG9zaXRpb25ZID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5kaXJlY3Rpb25ZID0gLTE7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5kaXJlY3Rpb25ZID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5zcGVlZFkgKz0gMztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnBvc2l0aW9uWSA8PSAwICYmIHRoaXMuc3RhdGUuc3BlZWRZIDwgODApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuYm9vc3RZID0gMDtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuc3BlZWRZID0gMDtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucG9zaXRpb25ZID0gMDtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uWSA9IDE7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5wb3NlID09PSAnanVtcCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFBvc2UoJ2xhbmRlZCcpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVuc2V0UG9zZSgnbGFuZGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5zZXRQb3NlKCdqdW1wJyk7XG4gICAgICAgICAgICAgICAgfSwzMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc3BlZWRZID4gMCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnBvc2UpIHRoaXMuc2V0UG9zZSgnanVtcCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2p1bXAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsZW1IZXJvLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnN0YXRlLnBvc2l0aW9uWH0lLCAkey10aGlzLnN0YXRlLnBvc2l0aW9uWX0lKWA7XG4gICAgICAgIGVsZW1EaXJlY3Rpb24uc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlWCgke3RoaXMuc3RhdGUuZGlyZWN0aW9ufSlgO1xuICAgICAgICBlbGVtVWlIZWFsdGguaW5uZXJUZXh0ID0gdGhpcy5zdGF0ZS5oZWFsdGg7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn1cbiIsImZ1bmN0aW9uIHBoeXNpY3MocG9zaXRpb24sIGJvb3N0LCBzcGVlZCwgZGlyZWN0aW9uLCBwb3NNYXgsIHBvc01pbikge1xuICAgIHNwZWVkID0gTWF0aC5hYnMoc3BlZWQpIDwgMSA/IDAgOiBzcGVlZDtcbiAgICBib29zdCA9IGJvb3N0IDw9IDAgPyAwIDogYm9vc3Q7XG5cbiAgICBpZiAoYm9vc3QgPiAwKSB7XG4gICAgICAgIGJvb3N0IC09IDEgKyAoTWF0aC5hYnMoYm9vc3QpIC8gMTAwKTtcbiAgICAgICAgc3BlZWQgKz0gMSArIChNYXRoLmFicyhib29zdCkgLyAxMDApO1xuICAgIH1cbiAgICBlbHNlIGlmIChzcGVlZCAhPT0gMCAmJiBzcGVlZCA+IDApIHtcbiAgICAgICAgc3BlZWQgLT0gMSArIChNYXRoLmFicyhzcGVlZCkgLyAxMDApO1xuICAgIH0gZWxzZSBpZiAoc3BlZWQgIT09IDAgJiYgc3BlZWQgPCAwKSB7XG4gICAgICAgIHNwZWVkICs9IDEgKyAoTWF0aC5hYnMoc3BlZWQpIC8gMTAwKTtcbiAgICB9XG5cbiAgICBwb3NpdGlvbiA9IHBvc2l0aW9uICsgc3BlZWQgLyAxMCAqIGRpcmVjdGlvbjtcblxuICAgIGlmIChwb3NpdGlvbiA+IHBvc01heCkge1xuICAgICAgICBkaXJlY3Rpb24gPSBzcGVlZCA+IDAgPyAtMSA6IDE7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA8IHBvc01pbikge1xuICAgICAgICBkaXJlY3Rpb24gPSBzcGVlZCA+IDAgPyAxIDogLTE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICBib29zdCA6IGJvb3N0LFxuICAgICAgICBzcGVlZCA6IHNwZWVkLFxuICAgICAgICBkaXJlY3Rpb24gOiBkaXJlY3Rpb25cbiAgICB9XG59O1xuIiwiZnVuY3Rpb24gVWkgKCkge1xuICAgIGxldCBjaGFyQ291bnRlciA9IDA7XG4gICAgbGV0IGZvdW5kID0gLTE7XG5cbiAgICB0aGlzLmVsZW1lbnRzID0gW107XG5cbiAgICB0aGlzLm1ha2VQaHJhc2UgPSAobGVuZ3RoKSA9PiB7XG4gICAgICAgIGxldCByZXN1bHQgICAgICAgICAgID0gJyc7XG4gICAgICAgIGxldCBjaGFyYWN0ZXJzICAgICAgID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JztcbiAgICAgICAgLy8gY2hhcmFjdGVycyAgICAgICAgICArPSAn0LDQsdCy0LPQtNC10LbQt9C40LnQutC70LzQvdC+0L/RgNGB0YLRg9GE0YXRhtGH0YjRidGK0YvRjNGN0Y7Rjyc7XG4gICAgICAgIC8vIGNoYXJhY3RlcnMgICAgICAgICAgKz0gJzAxMjM0NTY3ODknO1xuICAgICAgICAvLyBjaGFyYWN0ZXJzICAgICAgICAgICs9ICchQCMkJV4mKigpXytbXXt9XFx8OzpcXCdcIjw+LC4/Lyc7XG5cbiAgICAgICAgbGV0IGNoYXJhY3RlcnNMZW5ndGggICAgID0gY2hhcmFjdGVycy5sZW5ndGg7XG4gICAgICAgIGZvciAoIGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgbGV0IG5ld0NoYXIgPSBjaGFyYWN0ZXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFyYWN0ZXJzTGVuZ3RoKSk7XG4gICAgICAgICAgICBsZXQgc2tpcCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLm1hcCgoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3ltYm9sc1swXSA9PT0gbmV3Q2hhcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2tpcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc2tpcCkgcmVzdWx0ICs9IG5ld0NoYXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgbGV0IGVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnVpX19lbGVtZW50Jyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmVsZW1lbnRzW2ldID0gbmV3IFVpRWxlbWVudChlbGVtc1tpXSk7XG4gICAgICAgIGxldCBsZW5ndGggPSA0O1xuICAgICAgICBpZiAoY29uZmlnLmxlbmd0aFBocmFzZXNGb3JBY3Rpb25zW3RoaXMuZWxlbWVudHNbaV0uYWN0aW9uXSkge1xuICAgICAgICAgICAgbGVuZ3RoID0gY29uZmlnLmxlbmd0aFBocmFzZXNGb3JBY3Rpb25zW3RoaXMuZWxlbWVudHNbaV0uYWN0aW9uXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVsZW1lbnRzW2ldLnNldFRleHQodGhpcy5tYWtlUGhyYXNlKGxlbmd0aCkpO1xuICAgIH1cblxuICAgIGxldCB0aW1lU3RhcnQ7XG4gICAgbGV0IHRpbWVyRm91bmQ7XG5cbiAgICB0aGlzLmZvdW5kID0gKGtleSkgPT4ge1xuICAgICAgICBsZXQgYWN0aW9uUGxheWVkID0gZmFsc2U7XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyRm91bmQpO1xuICAgICAgICB0aW1lckZvdW5kID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZvdW5kKGZhbHNlKTtcbiAgICAgICAgfSwgMTIwMCk7XG5cbiAgICAgICAgaWYgKGZvdW5kIDwgMCkge1xuICAgICAgICAgICAgLy8g0J/QvtC40YHQuiDQv9C10YDQstC+0Lkg0LrQu9Cw0LLQuNGI0LhcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMubWFwKCh1aUVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHVpRWxlbWVudC5zeW1ib2xzW2NoYXJDb3VudGVyXSA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHVpRWxlbWVudC5lbGVtU3ltYm9sc1tjaGFyQ291bnRlcl0uY2xhc3NMaXN0LmFkZCgnZmFkZU91dERvd24nKTtcbiAgICAgICAgICAgICAgICAgICAgdWlFbGVtZW50LmVsZW1UZXh0LnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxLjUpJztcbiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgdGltZVN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdWlFbGVtZW50LmVsZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNoYXJDb3VudGVyKys7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50c1tmb3VuZF0uc3ltYm9sc1tjaGFyQ291bnRlcl0gPT09IGtleSkge1xuICAgICAgICAgICAgLy8g0KHQu9C10LTRg9GO0YnQsNGPINC60LvQsNCy0LjRiNCwINC90LDQttCw0YLQsFxuICAgICAgICAgICAgdGhpcy5lbGVtZW50c1tmb3VuZF0uZWxlbVN5bWJvbHNbY2hhckNvdW50ZXJdLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhZGVJbicpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50c1tmb3VuZF0uZWxlbVN5bWJvbHNbY2hhckNvdW50ZXJdLmNsYXNzTGlzdC5hZGQoJ2ZhZGVPdXREb3duJyk7XG4gICAgICAgICAgICBjaGFyQ291bnRlcisrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gINC+0YjQuNCx0YHRj1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50c1tmb3VuZF0uc2V0VGV4dCh0aGlzLm1ha2VQaHJhc2UodGhpcy5lbGVtZW50c1tmb3VuZF0udGV4dC5sZW5ndGgpKTtcbiAgICAgICAgICAgIGZvdW5kID0gLTE7XG4gICAgICAgICAgICBjaGFyQ291bnRlciA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZm91bmQgPj0gMCAmJiB0aGlzLmVsZW1lbnRzW2ZvdW5kXS5zeW1ib2xzLmxlbmd0aCA9PT0gY2hhckNvdW50ZXIpIHtcbiAgICAgICAgICAgIC8vINCf0L7RgdC70LXQtNC90LjRj9GPINC60LvQsNCy0LjRiNCwLCDQt9Cw0L/Rg9GB0LrQsNC10Lwg0LTQtdC50YHRgtCy0LjQtSwg0L/QtdGA0LXQs9C10L3QtdGA0LjRgNGD0LXQvCDRhNGA0LDQt9GDXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2ZvdW5kXS5zZXRUZXh0KHRoaXMubWFrZVBocmFzZSh0aGlzLmVsZW1lbnRzW2ZvdW5kXS50ZXh0Lmxlbmd0aCkpO1xuICAgICAgICAgICAgZ2FtZU9iamVjdHMucGxheWVyLnJ1bkFjdGlvbih0aGlzLmVsZW1lbnRzW2ZvdW5kXS5hY3Rpb24gLCArdGhpcy5lbGVtZW50c1tmb3VuZF0uZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIHRpbWVTdGFydCA9IDA7XG4gICAgICAgICAgICBmb3VuZCA9IC0xO1xuICAgICAgICAgICAgY2hhckNvdW50ZXIgPSAwO1xuICAgICAgICAgICAgYWN0aW9uUGxheWVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChmb3VuZCA+PSAwICkge1xuICAgICAgICAgICAgLy8g0J3QtSDQv9C+0YHQu9C10LTQvdGP0Y8g0LrQu9Cw0LLQuNGI0LAsINCy0YvQtNC10LvRj9C10Lwg0LXQtSDQutCw0Log0YHQu9C10LTRg9GO0YnRg9GOXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2ZvdW5kXS5lbGVtU3ltYm9sc1tjaGFyQ291bnRlcl0uY2xhc3NMaXN0LmFkZCgndWlfX3N5bWJvbF9zZWxlY3RlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZvdW5kIDwgMCl7XG4gICAgICAgICAgICAvLyDQktC+0LfQstGA0LDRgiDQsiDQuNGB0YXQvtC00L3Rg9GOXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLm1hcCgodWlFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdWlFbGVtZW50LmVsZW0uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgICAgIHVpRWxlbWVudC5lbGVtVGV4dC5zdHlsZS50cmFuc2Zvcm0gPSAnJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm91bmQgPSAtMTtcbiAgICAgICAgICAgIGNoYXJDb3VudGVyID0gMDtcbiAgICAgICAgICAgIGlmIChhY3Rpb25QbGF5ZWQpIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBVaUVsZW1lbnQgKGVsZW0pIHtcbiAgICAgICAgdGhpcy5lbGVtID0gZWxlbTtcbiAgICAgICAgdGhpcy50ZXh0ID0gJyc7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gZWxlbS5kYXRhc2V0LmFjdGlvbjtcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBlbGVtLmRhdGFzZXQuZGlyZWN0aW9uO1xuICAgICAgICB0aGlzLmljb24gPSBlbGVtLmRhdGFzZXQuaWNvbjtcbiAgICAgICAgdGhpcy5zeW1ib2xzID0gW107XG4gICAgICAgIHRoaXMuZWxlbVN5bWJvbHMgPSBbXTtcblxuICAgICAgICB0aGlzLmVsZW1UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuZWxlbVRleHQuY2xhc3NMaXN0LmFkZCgndWlfX3RleHQnKTtcbiAgICAgICAgdGhpcy5lbGVtLmFwcGVuZENoaWxkKHRoaXMuZWxlbVRleHQpO1xuXG4gICAgICAgIHRoaXMuZWxlbVVpSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmVsZW1VaUljb24uY2xhc3NMaXN0LmFkZCgndWlfX2ljb24nKTtcbiAgICAgICAgdGhpcy5lbGVtLmFwcGVuZENoaWxkKHRoaXMuZWxlbVVpSWNvbik7XG5cbiAgICAgICAgdGhpcy5lbGVtSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmVsZW1JY29uLmNsYXNzTGlzdC5hZGQoJ2ljb24nKTtcbiAgICAgICAgdGhpcy5lbGVtSWNvbi5jbGFzc0xpc3QuYWRkKCdpY29uXycgKyB0aGlzLmljb24pO1xuICAgICAgICB0aGlzLmVsZW1VaUljb24uYXBwZW5kQ2hpbGQodGhpcy5lbGVtSWNvbik7XG5cblxuICAgICAgICB0aGlzLnNldFRleHQgPSAodGV4dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgICAgIHRoaXMuZWxlbVRleHQuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAgICAgICAgIGxldCBmYWRlQ2xhc3MgPSAnZmFkZUluJztcbiAgICAgICAgICAgIGxldCBkZWxheSA9IDEwMDtcbiAgICAgICAgICAgIHRoaXMudGV4dC5zcGxpdCgnJykubWFwKChzeW1ib2wsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICAgICAgc3ltYm9sID0gc3ltYm9sID09PSAnICcgPyAnJm5ic3A7JyA6IHN5bWJvbDtcbiAgICAgICAgICAgICAgICB0aGlzLnN5bWJvbHNbaW5kZXhdID0gc3ltYm9sO1xuICAgICAgICAgICAgICAgIHNwYW4uaW5uZXJIVE1MID0gc3ltYm9sO1xuICAgICAgICAgICAgICAgIHNwYW4uY2xhc3NOYW1lID0gJ3VpX19zeW1ib2wgJyArIGZhZGVDbGFzcztcbiAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gaW5kZXggKiBkZWxheSArICdtcyc7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtU3ltYm9sc1tpbmRleF0gPSBzcGFuO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbVRleHQuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uY2xhc3NMaXN0LnJlbW92ZShmYWRlQ2xhc3MpO1xuICAgICAgICAgICAgICAgIH0sIChpbmRleCArIDEpICogZGVsYXkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuIiwiZnVuY3Rpb24gZnVuVGV4dChlbGVtVGV4dCwgYW5pbWF0ZUNsYXNzKSB7XG4gICAgbGV0IHRleHQgPSBlbGVtVGV4dC5pbm5lclRleHQ7XG4gICAgZWxlbVRleHQuaW5uZXJIVE1MID0gJyc7XG5cbiAgICB0ZXh0LnNwbGl0KCcnKS5tYXAoKHN5bWJvbCwgaW5kZXgpID0+IHtcbiAgICAgICAgbGV0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHN5bWJvbCA9IHN5bWJvbCA9PT0gJyAnID8gJyZuYnNwOycgOiBzeW1ib2w7XG4gICAgICAgIHNwYW4uaW5uZXJIVE1MID0gc3ltYm9sO1xuICAgICAgICBzcGFuLmNsYXNzTmFtZSA9IGFuaW1hdGVDbGFzcztcbiAgICAgICAgc3Bhbi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG4gICAgICAgIHNwYW4uc3R5bGUuYW5pbWF0aW9uRGVsYXkgPSBpbmRleCAqIDEwMCArICdtcyc7XG4gICAgICAgIGVsZW1UZXh0LmFwcGVuZENoaWxkKHNwYW4pO1xuICAgIH0pO1xufSIsInZhciBhY3RpdmVEcmF3c0xpc3QgPSBbXTtcbnZhciBzaG93RnJhbWVSYXRlID0gZmFsc2U7XG5cbmZ1bmN0aW9uIGFuaW1hdGUob3B0aW9ucykge1xuICAgIHZhciBvcHRpb25zICA9ICh0eXBlb2Yob3B0aW9ucykgICAgICAgICAgPT0gJ29iamVjdCcpICAgPyBvcHRpb25zICAgICAgICAgIDoge307XG4gICAgdmFyIGR1cmF0aW9uID0gKHR5cGVvZihvcHRpb25zLmR1cmF0aW9uKSA9PSAnbnVtYmVyJykgICA/IG9wdGlvbnMuZHVyYXRpb24gOiAxMDAwO1xuICAgIHZhciBkZWxheSAgICA9ICh0eXBlb2Yob3B0aW9ucy5kZWxheSkgICAgPT0gJ251bWJlcicpICAgPyBvcHRpb25zLmRlbGF5ICAgIDogMDtcbiAgICB2YXIgZnJvbSAgICAgPSAodHlwZW9mKG9wdGlvbnMuZnJvbSkgICAgID09ICdudW1iZXInKSAgID8gb3B0aW9ucy5mcm9tICAgICA6IDE7XG4gICAgdmFyIHRvICAgICAgID0gKHR5cGVvZihvcHRpb25zLnRvKSAgICAgICA9PSAnbnVtYmVyJykgICA/IG9wdGlvbnMudG8gICAgICAgOiAxMDA7XG4gICAgdmFyIHRpbWluZyAgID0gKHR5cGVvZihvcHRpb25zLnRpbWluZykgICA9PSAnZnVuY3Rpb24nKSA/IG9wdGlvbnMudGltaW5nICAgOiBsaW5lYXI7XG4gICAgdmFyIGRyYXcgICAgID0gKHR5cGVvZihvcHRpb25zLmRyYXcpICAgICA9PSAnZnVuY3Rpb24nKSA/IG9wdGlvbnMuZHJhdyAgICAgOiBmdW5jdGlvbihwcm9ncmVzcyl7Y29uc29sZS5sb2cocHJvZ3Jlc3MgKiAxMDApfTtcbiAgICB2YXIgYmVmb3JlICAgPSAodHlwZW9mKG9wdGlvbnMuYmVmb3JlKSAgID09ICdmdW5jdGlvbicpID8gb3B0aW9ucy5iZWZvcmUgICA6IGZ1bmN0aW9uKCkge307XG4gICAgdmFyIGFmdGVyICAgID0gKHR5cGVvZihvcHRpb25zLmFmdGVyKSAgICA9PSAnZnVuY3Rpb24nKSA/IG9wdGlvbnMuYWZ0ZXIgICAgOiBmdW5jdGlvbigpIHt9O1xuXG4gICAgdmFyIGZyYWN0aW9uRnJvbSA9IGZyb20gLyAxMDA7XG4gICAgdmFyIGZyYWN0aW9uVG8gICA9IHRvIC8gMTAwO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ICAgID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgIHZhciB0aW1lTGFzdCA9IHN0YXJ0O1xuXG4gICAgICAgIGZvciAodmFyIGkgPSBhY3RpdmVEcmF3c0xpc3QubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChhY3RpdmVEcmF3c0xpc3RbaV0gPT09IGRyYXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFuaW1hdGlvbkluZGV4ID0gYWN0aXZlRHJhd3NMaXN0LnB1c2goZHJhdyk7XG5cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIGFuaW1hdGUodGltZSkge1xuICAgICAgICAgICAgaWYgKGJlZm9yZSkge1xuICAgICAgICAgICAgICAgIGJlZm9yZSgpO1xuICAgICAgICAgICAgICAgIGJlZm9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRpbWVGcmFjdGlvbiA9ICh0aW1lIC0gc3RhcnQpIC8gZHVyYXRpb247XG4gICAgICAgICAgICBpZiAodGltZUZyYWN0aW9uID4gMSkgdGltZUZyYWN0aW9uID0gMTtcblxuICAgICAgICAgICAgaWYgKGZyYWN0aW9uRnJvbSA8IGZyYWN0aW9uVG8pIHtcbiAgICAgICAgICAgICAgICB0aW1lRnJhY3Rpb24gPSB0aW1lRnJhY3Rpb24gKyBmcmFjdGlvbkZyb207XG4gICAgICAgICAgICAgICAgdmFyIHRlcm1pbmF0aW9uQ29uZGl0aW9uID0gdGltZUZyYWN0aW9uIDwgZnJhY3Rpb25UbztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGltZUZyYWN0aW9uID0gLSh0aW1lRnJhY3Rpb24gLSBmcmFjdGlvbkZyb20pO1xuICAgICAgICAgICAgICAgIHZhciB0ZXJtaW5hdGlvbkNvbmRpdGlvbiA9IHRpbWVGcmFjdGlvbiA+IGZyYWN0aW9uVG87XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9IHRpbWluZyh0aW1lRnJhY3Rpb24pO1xuXG4gICAgICAgICAgICBkcmF3KHByb2dyZXNzKTtcblxuICAgICAgICAgICAgaWYgKHRlcm1pbmF0aW9uQ29uZGl0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNob3dGcmFtZVJhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZnJhbWVSYXRlKHRpbWVMYXN0LCB0aW1lKSwgTWF0aC5yb3VuZCh0aW1lRnJhY3Rpb24gKiAxMDApKTtcbiAgICAgICAgICAgICAgICAgICAgdGltZUxhc3QgPSB0aW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlRHJhd3NMaXN0LnNwbGljZShhY3RpdmVEcmF3c0xpc3QuaW5kZXhPZihkcmF3KSwgMSk7XG4gICAgICAgICAgICAgICAgaWYgKGFmdGVyKSBhZnRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LCBkZWxheSk7XG59XG5cbmZ1bmN0aW9uIGZyYW1lUmF0ZSh0aW1lTGFzdCwgdGltZU5vdykge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMDAgLyAodGltZU5vdyAtIHRpbWVMYXN0KSk7XG59XG5cbmZ1bmN0aW9uIHpvbmUoY3VycmVudCwgZnJvbSwgdG8sIGRyYXcpIHtcbiAgICBjdXJyZW50ID0gY3VycmVudCAqIDEwMDtcbiAgICBmcm9tICAgID0gZnJvbSAqIDEwMDtcbiAgICB0byAgICAgID0gdG8gKiAxMDA7XG4gICAgZHJhdyAgICA9IGRyYXcgKiAxMDA7XG5cbiAgICBpZiAoY3VycmVudCA+PSBmcm9tICYmIGN1cnJlbnQgPD0gdG8pIHtcbiAgICAgICAgdmFyIHByb2dyZXNzID0gKGN1cnJlbnQgLSBmcm9tKSAvICh0byAtIGZyb20pO1xuICAgICAgICBpZiAoZHJhdykgZHJhdyhwcm9ncmVzcyk7XG4gICAgICAgIHJldHVybiBwcm9ncmVzcztcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnQgPD0gZnJvbSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnQgPj0gdG8pIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxufVxuXG5cbi8vINC/0YDQtdC+0LHRgNCw0LfQvtCy0LDRgtC10LvRjCDQsiBlYXNlT3V0XG5mdW5jdGlvbiBtYWtlRWFzZU91dCh0aW1pbmcpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odGltZUZyYWN0aW9uKSB7XG4gICAgICAgIHJldHVybiAxIC0gdGltaW5nKDEgLSB0aW1lRnJhY3Rpb24pO1xuICAgIH1cbn1cbi8vINC/0YDQtdC+0LHRgNCw0LfQvtCy0LDRgtC10LvRjCDQsiBlYXNlT3V0XG5mdW5jdGlvbiBtYWtlRWFzZUluT3V0KHRpbWluZykge1xuICAgIHJldHVybiBmdW5jdGlvbih0aW1lRnJhY3Rpb24pIHtcbiAgICAgICAgaWYgKHRpbWVGcmFjdGlvbiA8IDAuNSlcbiAgICAgICAgICAgIHJldHVybiB0aW1pbmcoMiAqIHRpbWVGcmFjdGlvbikgLyAyO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gKDIgLSB0aW1pbmcoMiAqICgxIC0gdGltZUZyYWN0aW9uKSkpIC8gMjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGxpbmVhcihwcm9ncmVzcykge1xuICAgIHJldHVybiBwcm9ncmVzcztcbn1cblxuZnVuY3Rpb24gcXVhZChwcm9ncmVzcykge1xuICAgIHJldHVybiBNYXRoLnBvdyhwcm9ncmVzcywgMik7XG59XG52YXIgcXVhZEVhc2VPdXQgPSBtYWtlRWFzZU91dChxdWFkKTtcblxuZnVuY3Rpb24gY2lyYyh0aW1lRnJhY3Rpb24pIHtcbiAgICByZXR1cm4gMSAtIE1hdGguc2luKE1hdGguYWNvcyh0aW1lRnJhY3Rpb24pKVxufVxudmFyIGNpcmNFYXNlT3V0ID0gbWFrZUVhc2VPdXQoY2lyYyk7XG5cbmZ1bmN0aW9uIGJhY2soeCwgdGltZUZyYWN0aW9uKSB7XG4gICAgcmV0dXJuIE1hdGgucG93KHRpbWVGcmFjdGlvbiwgMikgKiAoKHggKyAxKSAqIHRpbWVGcmFjdGlvbiAtIHgpXG59XG52YXIgYmFja0Vhc2VPdXQgPSBtYWtlRWFzZU91dChiYWNrKTtcblxuZnVuY3Rpb24gYm91bmNlKHByb2dyZXNzKSB7XG4gICAgZm9yICh2YXIgYSA9IDAsIGIgPSAxLCByZXN1bHQ7IDE7IGEgKz0gYiwgYiAvPSAyKSB7XG4gICAgICAgIGlmIChwcm9ncmVzcyA+PSAoNyAtIDQgKiBhKSAvIDExKSB7XG4gICAgICAgICAgICByZXR1cm4gLU1hdGgucG93KCgxMSAtIDYgKiBhIC0gMTEgKiBwcm9ncmVzcykgLyA0LCAyKSArIE1hdGgucG93KGIsIDIpO1xuICAgICAgICB9XG4gICAgfVxufVxudmFyIGJvdW5jZUVhc2VPdXQgPSBtYWtlRWFzZU91dChib3VuY2UpO1xuXG5mdW5jdGlvbiBlbGFzdGljKHgsIHRpbWVGcmFjdGlvbikge1xuICAgIHJldHVybiBNYXRoLnBvdygyLCAxMCAqICh0aW1lRnJhY3Rpb24gLSAxKSkgKiBNYXRoLmNvcygyMCAqIE1hdGguUEkgKiB4IC8gMyAqIHRpbWVGcmFjdGlvbilcbn1cbnZhciBlbGFzdGljRWFzZU91dCA9IG1ha2VFYXNlT3V0KGVsYXN0aWMpO1xuIiwiLyoqXG4gKiDQodC+0LrRgNCw0YnQtdC90LjQtSDQtNC70Y8g0LTQvtCx0LDQstC70LXQvdC40Y8g0YHQvtCx0YvRgtC40Y8gRE9NQ29udGVudExvYWRlZFxuICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgQ9C70YPRiNCw0YLQtdC70Ywg0YHQvtCx0YvRgtC40Y9cbiAqL1xuZnVuY3Rpb24gcmVhZHkobGlzdGVuZXIpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBsaXN0ZW5lcik7XG59XG5cbi8qKlxuICogQ3VzdG9tIEV2ZW50IFJlc2l6ZVxuICovXG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRocm90dGxlID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgb2JqKSB7XG4gICAgICAgIG9iaiA9IG9iaiB8fCB3aW5kb3c7XG4gICAgICAgIHZhciBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgIHZhciBmdW5jID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAocnVubmluZykgeyByZXR1cm47IH1cbiAgICAgICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIG9iai5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChuYW1lKSk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGZ1bmMpO1xuICAgIH07XG5cbiAgICAvKiBpbml0IC0geW91IGNhbiBpbml0IGFueSBldmVudCAqL1xuICAgIHRocm90dGxlKFwicmVzaXplXCIsIFwib3B0aW1pemVkUmVzaXplXCIpO1xufSkoKTtcblxuXG4vKipcbiAqINCU0L7QsdCw0LLQu9C10L3QuNC1INGB0L7QsdGL0YLQuNC5XG4gKiBAcGFyYW0ge1t0eXBlXX0gICBvYmplY3QgICBET00g0YPQt9C10LtcbiAqIEBwYXJhbSB7c3RyaW5nfSAgIHR5cGUgICAgINCi0LjQvyDQv9GA0L7RgdC70YPRiNC40LLQsNC10LzQvtCz0L4g0YHQvtCx0YvRgtC40Y8uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBD0LvRg9GI0LDRgtC10LvRjCDRgdC+0LHRi9GC0LjRj1xuICovXG5mdW5jdGlvbiBhZGRFdmVudChvYmplY3QsIHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgaWYgKG9iamVjdCA9PSBudWxsIHx8IHR5cGVvZihvYmplY3QpID09ICd1bmRlZmluZWQnKSByZXR1cm47XG4gICAgaWYgKG9iamVjdC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgIG9iamVjdC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBmYWxzZSk7XG4gICAgfSBlbHNlIGlmIChvYmplY3QuYXR0YWNoRXZlbnQpIHtcbiAgICAgICAgb2JqZWN0LmF0dGFjaEV2ZW50KFwib25cIiArIHR5cGUsIGxpc3RlbmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBvYmplY3RbXCJvblwiICsgdHlwZV0gPSBsaXN0ZW5lcjtcbiAgICB9XG59O1xuXG4vKipcbiAqINGBb21wYXJlRnVuY3Rpb24g0LTQu9GPIGFyci5zb3J0LCDQtNC70Y8g0YHQvtGA0YLQuNGA0L7QutC4INGB0LvRg9GH0LnQvdC+0Lwg0L/QvtGA0Y/QtNC60LVcbiAqL1xuZnVuY3Rpb24gY29tcGFyZVJhbmRvbShhLCBiKSB7XG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgLSAwLjU7XG59XG5cbi8qKlxuICog0J/QvtC70YPRh9C10L3QuNC1IERPTSDQtNC10YDQtdCy0LAg0LTRgNGD0LPQvtC5INGB0YLRgNCw0L3QuNGG0YtcbiAqIEBwYXJhbSAge1N0cmluZ30gICB1cmwgICAgICBVUkwg0YHRgtGA0LDQvdC40YbRi1xuICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrINCf0LXRgNC10LTQsNCy0LDQtdC80LDRjyDRhNGD0L3QutGG0LjRj1xuICovXG5mdW5jdGlvbiBnZXREb2N1bWVudCh1cmwsIGNhbGxiYWNrKVxue1xuICB2YXIgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICBodHRwLm9wZW4oJ0dFVCcsIHVybCk7XG4gIGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKClcbiAge1xuICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT0gNCAmJiB0aGlzLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgIHZhciBkb2MgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHRoaXMucmVzcG9uc2VUZXh0LCBcInRleHQvaHRtbFwiKTsgIC8vINC/0YDQtdC+0LHRgNCw0LfQvtCy0LDRgtGMINGC0LXQutGB0YIg0LIgSFRNTFxuXG4gICAgICBjYWxsYmFjayhkb2MpO1xuICAgIH1cbiAgfVxuICBodHRwLnNlbmQobnVsbCk7XG59XG5cbi8qKlxuICogINCy0L7Qt9Cy0YDQsNGJ0LDQtdGCIGNvb2tpZSDRgSDQuNC80LXQvdC10LwgbmFtZSwg0LXRgdC70Lgg0LXRgdGC0YwsINC10YHQu9C4INC90LXRgiwg0YLQviB1bmRlZmluZWRcbiAqL1xuZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcbiAgdmFyIG1hdGNoZXMgPSBkb2N1bWVudC5jb29raWUubWF0Y2gobmV3IFJlZ0V4cChcbiAgICBcIig/Ol58OyApXCIgKyBuYW1lLnJlcGxhY2UoLyhbXFwuJD8qfHt9XFwoXFwpXFxbXFxdXFxcXFxcL1xcK15dKS9nLCAnXFxcXCQxJykgKyBcIj0oW147XSopXCJcbiAgKSk7XG4gIHJldHVybiBtYXRjaGVzID8gZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoZXNbMV0pIDogdW5kZWZpbmVkO1xufVxuIiwidmFyIGJyZWFrcG9pbnQgPSB7XG4gICAgJ3NtYWxsJzogNzY3LFxuICAgICdtZWRpdW0nOiA5OTIsXG4gICAgJ2xhcmdlJzogMTIwMFxufTtcblxuZnVuY3Rpb24gcmVzcG9uZFRvKGJyZWFrcG9pbnQsIGNhbGxiYWNrLCBydW5XaGVuQ2FsbGVkLCBhZGRFdmVudCkge1xuICAgIGlmIChicmVha3BvaW50ID49IHdpbmRvdy5pbm5lcldpZHRoKSB7XG4gICAgICAgIHZhciBhY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZiAocnVuV2hlbkNhbGxlZCkge1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBhY3RpdmUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoYWRkRXZlbnQpIHtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvcHRpbWl6ZWRSZXNpemVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGJyZWFrcG9pbnQgPj0gd2luZG93LmlubmVyV2lkdGgpIHtcblxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYnJlYWtwb2ludCA8PSB3aW5kb3cuaW5uZXJXaWR0aCkgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVzcG9uZEZyb20oYnJlYWtwb2ludCwgY2FsbGJhY2ssIHJ1bldoZW5DYWxsZWQsIGFkZEV2ZW50KSB7XG4gICAgaWYgKGJyZWFrcG9pbnQgPD0gd2luZG93LmlubmVyV2lkdGgpIHtcbiAgICAgICAgdmFyIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmIChydW5XaGVuQ2FsbGVkKSB7XG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChhZGRFdmVudCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9wdGltaXplZFJlc2l6ZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoYnJlYWtwb2ludCA8PSB3aW5kb3cuaW5uZXJXaWR0aCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChicmVha3BvaW50ID49IHdpbmRvdy5pbm5lcldpZHRoKSBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl19
