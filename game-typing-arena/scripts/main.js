"use strict";function funText(t,a){var n=t.innerText;t.innerHTML="",n.split("").map(function(n,e){var i=document.createElement("span");n=" "===n?"&nbsp;":n,i.innerHTML=n,i.className=a,i.style.display="inline-block",i.style.animationDelay=100*e+"ms",t.appendChild(i)})}
"use strict";function AnimationsLoop(){var t=this;this.array=[],this.paused=!1;function a(i){t.array.map(function(a){a(i)}),t.paused||requestAnimationFrame(a)}this.play=function(){t.paused=!1,requestAnimationFrame(a)},this.pause=function(){t.paused=!0},this.push=function(a){t.array.push(a)}}
"use strict";function AI(o){setInterval(function(){for(var a in gameObjects)if(gameObjects[a]!==o){var t=gameObjects[a].state.positionX-o.state.positionX;if(Math.abs(t)<=200)if(0===Math.round(Math.random()))r(0);else{var e=Math.floor(3*Math.random()+1);r(e)}else{var n=Math.floor(3*Math.random()+1);r(n)}}},1200);var r=function(a){switch(a){case 0:o.runAction("hit");break;case 1:o.runAction("move",1);break;case 2:o.runAction("move",-1);break;case 3:o.runAction("jump")}}}
"use strict";function Hero(s){var o=this,n=[],a=s.querySelector(".hero__direction"),i=s.querySelector(".ui"),c=document.createElement("div");c.className="hero__health",s.appendChild(c),this.state={action:!1,nextAction:!1,health:100,damage:0,pose:null,direction:1,directionY:1,positionX:0,positionY:0,speedX:0,boostX:0,speedY:0,boostY:0},this.setPose=function(t){return o.state.pose&&requestAnimationFrame(function(){s.classList.remove("hero_"+o.state.pose)}),t&&(o.state.pose=t,requestAnimationFrame(function(){s.classList.add("hero_"+t)})),o},this.unsetPose=function(t){return o.state.pose=null,requestAnimationFrame(function(){s.classList.remove("hero_"+t)}),o},this.setSkin=function(t){return s.classList.remove("hero_"+o.state.skin),(o.state.skin=t)&&s.classList.add("hero_"+t),o},this.runAction=function(t,e){if(o.state.health<=0||animationsLoop.paused)return o;if(1!==e&&-1!==e||e!==o.state.direction&&(o.state.direction=e,o.state.speedX=0),-1!==n.indexOf(t))return o.state.nextAction=[t,e],o;var s=!!r[t]&&r[t];if(!s)return o;n.push(t);var a=0;return s.map(function(t){setTimeout(t.action,a),a+=t.duration?t.duration:0}),setTimeout(function(){n.splice(n.indexOf(t,1)),o.state.nextAction&&(o.runAction(o.state.nextAction[0],o.state.nextAction[1]),o.state.nextAction=!1)},a),o};var r={jump:[{name:"jump-start",duration:1500,action:function(){0<!o.state.positionY&&(o.state.speedY=60,o.state.boostX=40)}}],down:[{name:"down-start",duration:500,action:function(){o.setPose("down")}},{name:"down-end",action:function(){o.unsetPose("down")}}],move:[{name:"Step1",duration:300,action:function(){o.state.boostX=35,o.state.pose||o.setPose("step-1")}},{name:"Step2",duration:300,action:function(){o.unsetPose("step-1"),o.state.pose||o.setPose("step-2")}},{name:"stop",action:function(){o.unsetPose("step-2")}}],damage:[{name:"takeDamageStart",duration:300,action:function(){console.log("takeDamageStart"),o.setPose("damage"),o.state.health-=o.state.damage,o.state.damage=0}},{name:"takeDamageEnd",action:function(){console.log("takeDamageEnd"),o.unsetPose("damage"),o.state.health<=0&&setTimeout(setDefault,3e3)}}],hit:[{name:"hit1",duration:300,action:function(){o.setPose("hit-1")}},{name:"hit2",duration:300,action:function(){o.unsetPose("hit-1"),o.setPose("hit-2");var t=!1;for(var e in gameObjects)if(gameObjects[e]!==o){var s=gameObjects[e].state.positionX-o.state.positionX,a=gameObjects[e].state.positionY-o.state.positionY;Math.abs(s)<=200&&Math.abs(a)<100&&(t||(0<s?(o.state.direction=1,gameObjects[e].state.direction=-1):(o.state.direction=-1,gameObjects[e].state.direction=1),t=!0),o.state.direction+gameObjects[e].state.direction===0&&0<s*o.state.direction&&(gameObjects[e].state.speedX=-50,gameObjects[e].state.damage+=10))}}},{name:"hitEnd",action:function(){o.unsetPose("hit-2")}}]};return animationsLoop.push(function(){var t=physics(o.state.positionX,o.state.boostX,o.state.speedX,o.state.direction,arena.xMax,arena.xMin);0<o.state.damage&&o.runAction("damage"),o.state.health<=0?(o.state.health=0,c.style.color="#222",o.setPose("dead"),i.style.display="none"):(o.unsetPose("dead"),i.style.display=""),0<o.state.health&&o.state.health<=30?c.style.color="#f00":30<o.state.health&&o.state.health<=60?c.style.color="#ff0":60<o.state.health&&(c.style.color="#0f0"),o.state.positionX=t.position,o.state.boostX=t.boost,o.state.speedX=t.speed,o.state.direction=t.direction;var e=physics(o.state.positionY,o.state.boostY,o.state.speedY,o.state.directionY,arena.yMax,arena.yMin);o.state.positionY=e.position,o.state.boostY=e.boost,o.state.speedY=e.speed,o.state.directionY=e.direction,0===o.state.speedY&&0<o.state.positionY&&(o.state.directionY=-1),-1===o.state.directionY&&(o.state.speedY+=3),o.state.positionY<=0&&o.state.speedY<80&&(o.state.boostY=0,o.state.speedY=0,o.state.positionY=0,o.state.directionY=1,"jump"===o.state.pose&&(o.setPose("landed"),setTimeout(function(){o.unsetPose("landed"),o.unsetPose("jump")},300))),0<o.state.speedY?o.state.pose||o.setPose("jump"):o.unsetPose("jump"),s.style.transform="translate(".concat(o.state.positionX,"%, ").concat(-o.state.positionY,"%)"),a.style.transform="scaleX(".concat(o.state.direction,")"),c.innerText=o.state.health}),this}
"use strict";function physics(s,t,a,i,b,h){return a=Math.abs(a)<1?0:a,0<(t=t<=0?0:t)?(t-=1+Math.abs(t)/100,a+=1+Math.abs(t)/100):0!==a&&0<a?a-=1+Math.abs(a)/100:0!==a&&a<0&&(a+=1+Math.abs(a)/100),b<(s+=a/10*i)?i=0<a?-1:1:s<h&&(i=0<a?1:-1),{position:s,boost:t,speed:a,direction:i}}
"use strict";function Ui(){var o=this,n=0,i=-1;this.elements=[],this.makePhrase=function(e){for(var i="",l="abcdefghijklmnopqrstuvwxyz",m=l.length,t=function(t){var s=l.charAt(Math.floor(Math.random()*m)),n=!1;0===t&&o.elements.map(function(e){e.symbols[0]===s&&(t=-1,n=!0)}),n||(i+=s),a=t},a=0;a<e;a++)t(a);return i};for(var t,e=document.querySelectorAll(".ui__element"),s=0;s<e.length;s++){this.elements[s]=new m(e[s]);var l=4;config.lengthPhrasesForActions[this.elements[s].action]&&(l=config.lengthPhrasesForActions[this.elements[s].action]),this.elements[s].setText(this.makePhrase(l))}function m(e){var i=this;return this.elem=e,this.text="",this.action=e.dataset.action,this.direction=e.dataset.direction,this.icon=e.dataset.icon,this.symbols=[],this.elemSymbols=[],this.elemText=document.createElement("div"),this.elemText.classList.add("ui__text"),this.elem.appendChild(this.elemText),this.elemUiIcon=document.createElement("div"),this.elemUiIcon.classList.add("ui__icon"),this.elem.appendChild(this.elemUiIcon),this.elemIcon=document.createElement("div"),this.elemIcon.classList.add("icon"),this.elemIcon.classList.add("icon_"+this.icon),this.elemUiIcon.appendChild(this.elemIcon),this.setText=function(e){i.text=e,i.elemText.innerHTML="";var n="fadeIn";i.text.split("").map(function(e,t){var s=document.createElement("span");e=" "===e?"&nbsp;":e,i.symbols[t]=e,s.innerHTML=e,s.className="ui__symbol "+n,s.style.display="inline-block",s.style.animationDelay=100*t+"ms",i.elemSymbols[t]=s,i.elemText.appendChild(s),setTimeout(function(){s.classList.remove(n)},100*(t+1))})},this}this.found=function(s){var e=!1;return clearTimeout(t),t=setTimeout(function(){o.found(!1)},1200),i<0?(o.elements.map(function(e,t){e.symbols[n]===s?(e.elemSymbols[n].classList.add("fadeOutDown"),e.elemText.style.transform="scale(1.5)",i=t,performance.now()):e.elem.style.display="none"}),n++):o.elements[i].symbols[n]===s?(o.elements[i].elemSymbols[n].classList.remove("fadeIn"),o.elements[i].elemSymbols[n].classList.add("fadeOutDown"),n++):(o.elements[i].setText(o.makePhrase(o.elements[i].text.length)),i=-1,n=0),0<=i&&o.elements[i].symbols.length===n?(o.elements[i].setText(o.makePhrase(o.elements[i].text.length)),gameObjects.player.runAction(o.elements[i].action,+o.elements[i].direction),i=-1,e=!(n=0)):0<=i&&o.elements[i].elemSymbols[n].classList.add("ui__symbol_selected"),i<0&&(o.elements.map(function(e){e.elem.style.display="",e.elemText.style.transform=""}),i=-1,n=0,!!e)}}
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var activeDrawsList=[],showFrameRate=!1;function animate(t){var i="number"==typeof(t="object"==_typeof(t)?t:{}).duration?t.duration:1e3,e="number"==typeof t.delay?t.delay:0,n="number"==typeof t.from?t.from:1,o="number"==typeof t.to?t.to:100,f="function"==typeof t.timing?t.timing:linear,c="function"==typeof t.draw?t.draw:function(t){console.log(100*t)},s="function"==typeof t.before?t.before:function(){},m="function"==typeof t.after?t.after:function(){},p=n/100,y=o/100;setTimeout(function(){for(var a=performance.now(),u=a,t=activeDrawsList.length-1;0<=t;t--)if(activeDrawsList[t]===c)return!1;activeDrawsList.push(c);requestAnimationFrame(function t(e){s&&(s(),s=!1);var n=(e-a)/i;if(1<n&&(n=1),p<y)var o=(n+=p)<y;else o=y<(n=-(n-p));var r=f(n);c(r),o?(requestAnimationFrame(t),showFrameRate&&(console.log(frameRate(u,e),Math.round(100*n)),u=e)):(activeDrawsList.splice(activeDrawsList.indexOf(c),1),m&&m())})},e)}function frameRate(t,e){return Math.round(1e3/(e-t))}function zone(t,e,n,o){if(n*=100,o*=100,(e*=100)<=(t*=100)&&t<=n){var r=(t-e)/(n-e);return o&&o(r),r}return t<=e?0:n<=t?1:void 0}function makeEaseOut(e){return function(t){return 1-e(1-t)}}function makeEaseInOut(e){return function(t){return t<.5?e(2*t)/2:(2-e(2*(1-t)))/2}}function linear(t){return t}function quad(t){return Math.pow(t,2)}var quadEaseOut=makeEaseOut(quad);function circ(t){return 1-Math.sin(Math.acos(t))}var circEaseOut=makeEaseOut(circ);function back(t,e){return Math.pow(e,2)*((t+1)*e-t)}var backEaseOut=makeEaseOut(back);function bounce(t){for(var e=0,n=1;;e+=n,n/=2)if((7-4*e)/11<=t)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(n,2)}var bounceEaseOut=makeEaseOut(bounce);function elastic(t,e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}var elasticEaseOut=makeEaseOut(elastic);
"use strict";function ready(e){document.addEventListener("DOMContentLoaded",e)}function addEvent(e,t,n){null!=e&&void 0!==e&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)}function compareRandom(e,t){return Math.random()-.5}function getDocument(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=(new DOMParser).parseFromString(this.responseText,"text/html");t(e)}},n.send(null)}function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}!function(e,t,n){n=n||window;var o=!1;n.addEventListener(e,function(){o||(o=!0,requestAnimationFrame(function(){n.dispatchEvent(new CustomEvent(t)),o=!1}))})}("resize","optimizedResize");
"use strict";var breakpoint={small:767,medium:992,large:1200};function respondTo(i,n,e,t){if(i>=window.innerWidth){var r=!0;e&&requestAnimationFrame(n)}else r=!1;t&&window.addEventListener("optimizedResize",function(){if(!r&&(r=!0,i>=window.innerWidth))return setTimeout(function(){requestAnimationFrame(n)},100),!0;i<=window.innerWidth&&(r=!1)})}function respondFrom(i,n,e,t){if(i<=window.innerWidth){var r=!0;e&&requestAnimationFrame(n)}else r=!1;t&&window.addEventListener("optimizedResize",function(){if(!r&&(r=!0,i<=window.innerWidth))return setTimeout(function(){requestAnimationFrame(n)},100),!0;i>=window.innerWidth&&(r=!1)})}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1hdGlvbnMvZnVuVGV4dC5qcyIsImNvbXBvbmVudHMvQW5pbWF0aW9uc0xvb3AuanMiLCJjb21wb25lbnRzL2FpLmpzIiwiY29tcG9uZW50cy9oZXJvLmpzIiwiY29tcG9uZW50cy9waHlzaWNzLmpzIiwiY29tcG9uZW50cy91aS5qcyIsImhlbHBlcnMvYW5pbWF0ZS5qcyIsImhlbHBlcnMvb3RoZXJzLmpzIiwiaGVscGVycy9yZXNwb25kLmpzIl0sIm5hbWVzIjpbImZ1blRleHQiLCJlbGVtVGV4dCIsImFuaW1hdGVDbGFzcyIsInRleHQiLCJpbm5lclRleHQiLCJpbm5lckhUTUwiLCJzeW1ib2wiLCJpbmRleCIsInNwbGl0Iiwic3BhbiIsIm1hcCIsImNyZWF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImNsYXNzTmFtZSIsImRpc3BsYXkiLCJzdHlsZSIsImFuaW1hdGlvbkRlbGF5IiwiQW5pbWF0aW9uc0xvb3AiLCJfdGhpcyIsInRoaXMiLCJhcnJheSIsImxvb3AiLCJ0aW1lIiwiYW5pbWF0ZSIsInBhdXNlZCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInBsYXkiLCJwdXNoIiwiZWxlbSIsInBhdXNlIiwiQUkiLCJoZXJvIiwic2V0SW50ZXJ2YWwiLCJrZXkiLCJnYW1lT2JqZWN0cyIsImRpc3RhbmNlIiwic3RhdGUiLCJwb3NpdGlvblgiLCJhYnMiLCJzd2l0Y2hBY3Rpb24iLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJhY3Rpb25JbmRleCIsInJ1bkFjdGlvbiIsIkhlcm8iLCJlbGVtSGVybyIsImFjdGl2ZUFjdGlvbnMiLCJxdWVyeVNlbGVjdG9yIiwiZWxlbVVpIiwiZWxlbURpcmVjdGlvbiIsImVsZW1VaUhlYWx0aCIsImFwcGVuZENoaWxkIiwiYWN0aW9uIiwibmV4dEFjdGlvbiIsImhlYWx0aCIsImRhbWFnZSIsImRpcmVjdGlvbiIsImRpcmVjdGlvblkiLCJwb3NpdGlvblkiLCJzcGVlZFgiLCJib29zdFgiLCJzcGVlZFkiLCJzZXRQb3NlIiwicG9zZSIsInJlbW92ZSIsImFkZCIsInVuc2V0UG9zZSIsImNsYXNzTGlzdCIsInNldFNraW4iLCJza2luIiwiYWN0aW9uTmFtZSIsImFuaW1hdGlvbnNMb29wIiwiaW5kZXhPZiIsImFjdGlvbnMiLCJkZWxheSIsImFjdGlvblN0ZXAiLCJzZXRUaW1lb3V0IiwiZHVyYXRpb24iLCJzcGxpY2UiLCJqdW1wIiwibmFtZSIsImNvbnNvbGUiLCJsb2ciLCJzZXREZWZhdWx0IiwiaGl0IiwiY2hhbmdlZERpcmVjdGlvbiIsImRpc3RhbmNlWSIsIm5leHRQb3NpdGlvbnNYIiwiY29sb3IiLCJhcmVuYSIsInhNYXgiLCJuZXh0UG9zaXRpb25zWSIsInBoeXNpY3MiLCJwb3NpdGlvbiIsImJvb3N0Iiwic3BlZWQiLCJib29zdFkiLCJ0cmFuc2Zvcm0iLCJjb25jYXQiLCJwb3NNYXgiLCJwb3NNaW4iLCJVaSIsImNoYXJDb3VudGVyIiwiZm91bmQiLCJlbGVtZW50cyIsImxlbmd0aCIsImNoYXJhY3RlcnMiLCJjaGFyYWN0ZXJzTGVuZ3RoIiwiX2xvb3AiLCJfaSIsImNoYXJBdCIsInNraXAiLCJpIiwibmV3Q2hhciIsImVsZW1lbnQiLCJzeW1ib2xzIiwicmVzdWx0IiwiZWxlbXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiVWlFbGVtZW50IiwiY29uZmlnIiwibGVuZ3RoUGhyYXNlc0ZvckFjdGlvbnMiLCJzZXRUZXh0IiwibWFrZVBocmFzZSIsIl90aGlzMiIsImRhdGFzZXQiLCJ1aUVsZW1lbnQiLCJlbGVtU3ltYm9scyIsImFjdGlvblBsYXllZCIsImVsZW1VaUljb24iLCJlbGVtSWNvbiIsImljb24iLCJmYWRlQ2xhc3MiLCJjbGVhclRpbWVvdXQiLCJ0aW1lckZvdW5kIiwicGVyZm9ybWFuY2UiLCJub3ciLCJ0aW1lU3RhcnQiLCJwbGF5ZXIiLCJhY3RpdmVEcmF3c0xpc3QiLCJzaG93RnJhbWVSYXRlIiwib3B0aW9ucyIsIl90eXBlb2YiLCJmcm9tIiwidG8iLCJsaW5lYXIiLCJkcmF3IiwicHJvZ3Jlc3MiLCJiZWZvcmUiLCJhZnRlciIsInN0YXJ0IiwiZnJhY3Rpb25Gcm9tIiwiYW5pbWF0aW9uSW5kZXgiLCJ0aW1lRnJhY3Rpb24iLCJmcmFjdGlvblRvIiwidGltaW5nIiwidGVybWluYXRpb25Db25kaXRpb24iLCJmcmFtZVJhdGUiLCJ0aW1lTGFzdCIsInJvdW5kIiwidGltZU5vdyIsImN1cnJlbnQiLCJtYWtlRWFzZU91dCIsIm1ha2VFYXNlSW5PdXQiLCJxdWFkIiwicXVhZEVhc2VPdXQiLCJzaW4iLCJhY29zIiwiY2lyY0Vhc2VPdXQiLCJiYWNrIiwieCIsInBvdyIsImJhY2tFYXNlT3V0IiwiYm91bmNlIiwiYSIsImIiLCJib3VuY2VFYXNlT3V0IiwiZWxhc3RpYyIsImNvcyIsIlBJIiwicmVhZHkiLCJsaXN0ZW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJhZGRFdmVudCIsIm9iamVjdCIsInR5cGUiLCJhdHRhY2hFdmVudCIsImNvbXBhcmVSYW5kb20iLCJnZXREb2N1bWVudCIsInVybCIsImNhbGxiYWNrIiwiaHR0cCIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJkb2MiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJyZXNwb25zZVRleHQiLCJzZW5kIiwiZ2V0Q29va2llIiwibWF0Y2hlcyIsInJlcGxhY2UiLCJkZWNvZGVVUklDb21wb25lbnQiLCJ1bmRlZmluZWQiLCJvYmoiLCJ3aW5kb3ciLCJydW5uaW5nIiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwiYnJlYWtwb2ludCIsInNtYWxsIiwibGFyZ2UiLCJyZXNwb25kVG8iLCJydW5XaGVuQ2FsbGVkIiwiaW5uZXJXaWR0aCIsImFjdGl2ZSIsInJlc3BvbmRGcm9tIl0sIm1hcHBpbmdzIjoiYUFBQSxTQUFTQSxRQUFRQyxFQUFVQyxHQUN2QixJQUFJQyxFQUFPRixFQUFTRyxVQUR4QkgsRUFBU0QsVUFBVCxHQUVJQyxFQUFBQSxN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RUFBQUUsbUJBQUFGLEVBQUEsU0FBQUcsR0ExRGMsU0FBU3JCLEVBQU16RyxFQUFNK0gsR0FDaENBLEVBQU1BLEdBQU9DLE9BRnBCLElBQUFDLEdBQVcsRUFZSkYsRUFBSXpCLGlCQUFpQkcsRUFYVixXQUNGd0IsSUFDTEEsR0FBVSxFQUlWekwsc0JBQXNCLFdBSGZ1TCxFQUFBRyxjQUFXLElBQUFDLFlBQUFuSSxJQUNkaUksR0FBUyxPQUlUQSxDQUFBQSxTQUFBO2FDcEJoQixJQUFJRyxXQUFhLENBQ2JDLE1BQVMsSUFEVEQsT0FBVSxJQUNWRSxNQUFTLE1BREksU0FBakJDLFVBQUFILEVBQUF0QixFQUFBMEIsRUFBQWpDLEdBT0ksR0FBSTZCLEdBQWNKLE9BQU9TLFdBQVksQ0FEekMsSUFBU0YsR0FBVUgsRUFDWEEsR0FDSU0sc0JBQUo1QixRQUVJdEssR0FBQUEsRUFHQWtNLEdBQ1BWLE9BQUExQixpQkFBQSxrQkFBQSxXQUlPLElBQUtvQyxJQUZDQSxHQUFBLEVBQ0hwQyxHQUFpQjBCLE9BQUFTLFlBS0YsT0FITDdJLFdBQVQsV0FJUXBELHNCQUFzQnNLLElBSGhCLE1BRUMsRUFHWHNCLEdBQUFKLE9BQUFTLGFBQUFDLEdBQUEsS0FJWCxTQVpEQyxZQUFBUCxFQUFBdEIsRUFBQTBCLEVBQUFqQyxHQWFILEdBQUE2QixHQUFBSixPQUFBUyxXQUFBLENBQ0osSUFBQUMsR0FBQSxFQUtXRixHQUhIRyxzQkFBd0I3QixRQU9yQjRCLEdBQVMsRUFGWm5DLEdBSkx5QixPQUtPMUIsaUJBQUEsa0JBQUEsV0FDQ29DLElBQVNBLElBQ2hCQSxHQUFBLEVBTWVOLEdBQWNKLE9BQU9TLFlBS3JCLE9BUkxuQyxXQUFpQixXQUNQOUosc0JBQUFzSyxJQUNULE1BTVcsRUFGSHRLLEdBQUFBLE9BQXNCc0ssYUFBdEI0QixHQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBmdW5UZXh0KGVsZW1UZXh0LCBhbmltYXRlQ2xhc3MpIHtcbiAgICBsZXQgdGV4dCA9IGVsZW1UZXh0LmlubmVyVGV4dDtcbiAgICBlbGVtVGV4dC5pbm5lckhUTUwgPSAnJztcblxuICAgIHRleHQuc3BsaXQoJycpLm1hcCgoc3ltYm9sLCBpbmRleCkgPT4ge1xuICAgICAgICBsZXQgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgc3ltYm9sID0gc3ltYm9sID09PSAnICcgPyAnJm5ic3A7JyA6IHN5bWJvbDtcbiAgICAgICAgc3Bhbi5pbm5lckhUTUwgPSBzeW1ib2w7XG4gICAgICAgIHNwYW4uY2xhc3NOYW1lID0gYW5pbWF0ZUNsYXNzO1xuICAgICAgICBzcGFuLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgc3Bhbi5zdHlsZS5hbmltYXRpb25EZWxheSA9IGluZGV4ICogMTAwICsgJ21zJztcbiAgICAgICAgZWxlbVRleHQuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgfSk7XG59IiwiZnVuY3Rpb24gQW5pbWF0aW9uc0xvb3AoKSB7XG4gICAgdGhpcy5hcnJheSA9IFtdO1xuICAgIHRoaXMucGF1c2VkID0gZmFsc2U7XG5cbiAgICBjb25zdCBsb29wID0gKHRpbWUpID0+IHtcbiAgICAgICAgdGhpcy5hcnJheS5tYXAoYW5pbWF0ZSA9PiB7XG4gICAgICAgICAgICBhbmltYXRlKHRpbWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCF0aGlzLnBhdXNlZCkgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xuICAgIH07XG5cbiAgICB0aGlzLnBsYXkgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMucGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcbiAgICB9O1xuXG4gICAgdGhpcy5wYXVzZSA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5wYXVzZWQgPSB0cnVlO1xuICAgIH07XG5cbiAgICB0aGlzLnB1c2ggPSAoZWxlbSkgPT4ge1xuICAgICAgICB0aGlzLmFycmF5LnB1c2goZWxlbSk7XG4gICAgfTtcbn0iLCJmdW5jdGlvbiBBSShoZXJvKSB7XG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBsZXQgaTtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGdhbWVPYmplY3RzKSB7XG4gICAgICAgICAgICBpZiAoZ2FtZU9iamVjdHNba2V5XSAhPT0gaGVybykge1xuICAgICAgICAgICAgICAgIGxldCBkaXN0YW5jZSA9IGdhbWVPYmplY3RzW2tleV0uc3RhdGUucG9zaXRpb25YIC0gaGVyby5zdGF0ZS5wb3NpdGlvblg7XG5cbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZGlzdGFuY2UpIDw9IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoQWN0aW9uKDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGlvbkluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMyArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoQWN0aW9uKGFjdGlvbkluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhY3Rpb25JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoQWN0aW9uKGFjdGlvbkluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCAxMjAwKTtcblxuXG4gICAgY29uc3Qgc3dpdGNoQWN0aW9uID0gKGluZGV4KSA9PiB7XG4gICAgICAgIHN3aXRjaCAoaW5kZXgpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBoZXJvLnJ1bkFjdGlvbignaGl0Jyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgaGVyby5ydW5BY3Rpb24oJ21vdmUnLCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBoZXJvLnJ1bkFjdGlvbignbW92ZScsIC0xKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBoZXJvLnJ1bkFjdGlvbignanVtcCcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxufSIsImZ1bmN0aW9uIEhlcm8oZWxlbUhlcm8pIHtcbiAgICBjb25zdCBhY3RpdmVBY3Rpb25zID0gW107XG4gICAgY29uc3QgZWxlbURpcmVjdGlvbiA9IGVsZW1IZXJvLnF1ZXJ5U2VsZWN0b3IoJy5oZXJvX19kaXJlY3Rpb24nKTtcbiAgICBjb25zdCBlbGVtVWkgPSBlbGVtSGVyby5xdWVyeVNlbGVjdG9yKCcudWknKTtcblxuXG4gICAgY29uc3QgZWxlbVVpSGVhbHRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZWxlbVVpSGVhbHRoLmNsYXNzTmFtZSA9ICdoZXJvX19oZWFsdGgnO1xuICAgIGVsZW1IZXJvLmFwcGVuZENoaWxkKGVsZW1VaUhlYWx0aCk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICBhY3Rpb246IGZhbHNlLFxuICAgICAgICBuZXh0QWN0aW9uOiBmYWxzZSxcbiAgICAgICAgaGVhbHRoOiAxMDAsXG4gICAgICAgIGRhbWFnZTogMCxcbiAgICAgICAgcG9zZTogbnVsbCxcbiAgICAgICAgZGlyZWN0aW9uOiAxLFxuICAgICAgICBkaXJlY3Rpb25ZOiAxLFxuICAgICAgICBwb3NpdGlvblg6IDAsXG4gICAgICAgIHBvc2l0aW9uWTogMCxcbiAgICAgICAgc3BlZWRYOiAwLFxuICAgICAgICBib29zdFg6IDAsXG4gICAgICAgIHNwZWVkWTogMCxcbiAgICAgICAgYm9vc3RZOiAwXG4gICAgfTtcblxuICAgIHRoaXMuc2V0UG9zZSA9IChwb3NlKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnBvc2UpIHtcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgZWxlbUhlcm8uY2xhc3NMaXN0LnJlbW92ZSgnaGVyb18nICsgdGhpcy5zdGF0ZS5wb3NlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBvc2UpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucG9zZSA9IHBvc2U7XG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVsZW1IZXJvLmNsYXNzTGlzdC5hZGQoJ2hlcm9fJyArIHBvc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgdGhpcy51bnNldFBvc2UgPSAocG9zZSkgPT4ge1xuICAgICAgICB0aGlzLnN0YXRlLnBvc2UgPSBudWxsO1xuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVsZW1IZXJvLmNsYXNzTGlzdC5yZW1vdmUoJ2hlcm9fJyArIHBvc2UpO1xuICAgICAgICAgICAgICAgIC8vIFRPRE86INCS0L7Qt9C80L7QttC90L4g0L3Rg9C20L3QviDQsdGD0LTQtdGCINCy0L7Qt9Cy0YDQsNGJ0LDRgtGMINC/0YDQtdC00YvQtNGD0YnRg9GOINC/0L7Qt9GDXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgdGhpcy5zZXRTa2luID0gKHNraW4pID0+IHtcbiAgICAgICAgZWxlbUhlcm8uY2xhc3NMaXN0LnJlbW92ZSgnaGVyb18nICsgdGhpcy5zdGF0ZS5za2luKTtcbiAgICAgICAgdGhpcy5zdGF0ZS5za2luID0gc2tpbjtcbiAgICAgICAgaWYgKHNraW4pIHtcbiAgICAgICAgICAgIGVsZW1IZXJvLmNsYXNzTGlzdC5hZGQoJ2hlcm9fJyArIHNraW4pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICB0aGlzLnJ1bkFjdGlvbiA9IChhY3Rpb25OYW1lLCBkaXJlY3Rpb24pID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaGVhbHRoIDw9IDAgfHwgYW5pbWF0aW9uc0xvb3AucGF1c2VkKSByZXR1cm4gdGhpcztcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gMSB8fCBkaXJlY3Rpb24gPT09IC0xKSB7XG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uICE9PSB0aGlzLnN0YXRlLmRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuc3BlZWRYID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3RpdmVBY3Rpb25zLmluZGV4T2YoIGFjdGlvbk5hbWUgKSAhPT0gLTEgKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLm5leHRBY3Rpb24gPSBbYWN0aW9uTmFtZSwgZGlyZWN0aW9uXTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYWN0aW9uID0gYWN0aW9uc1thY3Rpb25OYW1lXSA/IGFjdGlvbnNbYWN0aW9uTmFtZV0gOiBmYWxzZTtcbiAgICAgICAgaWYgKCFhY3Rpb24pIHJldHVybiB0aGlzO1xuXG4gICAgICAgIGFjdGl2ZUFjdGlvbnMucHVzaChhY3Rpb25OYW1lKTtcblxuICAgICAgICBsZXQgZGVsYXkgPSAwO1xuICAgICAgICBhY3Rpb24ubWFwKChhY3Rpb25TdGVwLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgc2V0VGltZW91dChhY3Rpb25TdGVwLmFjdGlvbiwgZGVsYXkpO1xuICAgICAgICAgICAgZGVsYXkgKz0gYWN0aW9uU3RlcC5kdXJhdGlvbiA/IGFjdGlvblN0ZXAuZHVyYXRpb24gOiAwO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGFjdGl2ZUFjdGlvbnMuc3BsaWNlKGFjdGl2ZUFjdGlvbnMuaW5kZXhPZihhY3Rpb25OYW1lLCAxKSk7XG5cbiAgICAgICAgICAgIGlmKHRoaXMuc3RhdGUubmV4dEFjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMucnVuQWN0aW9uKHRoaXMuc3RhdGUubmV4dEFjdGlvblswXSwgdGhpcy5zdGF0ZS5uZXh0QWN0aW9uWzFdKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLm5leHRBY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZGVsYXkpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBjb25zdCBhY3Rpb25zID0ge1xuICAgICAgICAnanVtcCc6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnanVtcC1zdGFydCcsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDE1MDAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5wb3NpdGlvblkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnNwZWVkWSA9IDYwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFggPSA0MDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgJ2Rvd24nIDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdkb3duLXN0YXJ0JyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFBvc2UoJ2Rvd24nKTs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnZG93bi1lbmQnLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVuc2V0UG9zZSgnZG93bicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgJ21vdmUnIDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdTdGVwMScsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDMwMCxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFggPSAzNTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnBvc2UpIHRoaXMuc2V0UG9zZSgnc3RlcC0xJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnU3RlcDInLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAzMDAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5zZXRQb3NlKCdzdGVwLTEnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnBvc2UpIHRoaXMuc2V0UG9zZSgnc3RlcC0yJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnc3RvcCcsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5zZXRQb3NlKCdzdGVwLTInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgICdkYW1hZ2UnIDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICd0YWtlRGFtYWdlU3RhcnQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAzMDAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YWtlRGFtYWdlU3RhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQb3NlKCdkYW1hZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5oZWFsdGggLT0gdGhpcy5zdGF0ZS5kYW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZGFtYWdlID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICd0YWtlRGFtYWdlRW5kJyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Rha2VEYW1hZ2VFbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2RhbWFnZScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5oZWFsdGggPD0gMCkgc2V0VGltZW91dChzZXREZWZhdWx0LCAzMDAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgICdoaXQnIDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG5hbWU6ICdoaXQxJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMzAwLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFBvc2UoJ2hpdC0xJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnaGl0MicsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IDMwMCxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2hpdC0xJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0UG9zZSgnaGl0LTInKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNoYW5nZWREaXJlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGdhbWVPYmplY3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWVPYmplY3RzW2tleV0gIT09IHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRpc3RhbmNlID0gIGdhbWVPYmplY3RzW2tleV0uc3RhdGUucG9zaXRpb25YIC0gdGhpcy5zdGF0ZS5wb3NpdGlvblg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkaXN0YW5jZVkgPSBnYW1lT2JqZWN0c1trZXldLnN0YXRlLnBvc2l0aW9uWSAtIHRoaXMuc3RhdGUucG9zaXRpb25ZO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhkaXN0YW5jZSkgPD0gMjAwICYmIE1hdGguYWJzKGRpc3RhbmNlWSkgPCAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2hhbmdlZERpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5kaXJlY3Rpb24gPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lT2JqZWN0c1trZXldLnN0YXRlLmRpcmVjdGlvbiA9IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uID0gLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVPYmplY3RzW2tleV0uc3RhdGUuZGlyZWN0aW9uID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZERpcmVjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmRpcmVjdGlvbiArIGdhbWVPYmplY3RzW2tleV0uc3RhdGUuZGlyZWN0aW9uID09PSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgZGlzdGFuY2UgKiB0aGlzLnN0YXRlLmRpcmVjdGlvbiA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lT2JqZWN0c1trZXldLnN0YXRlLnNwZWVkWCA9IC01MDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lT2JqZWN0c1trZXldLnN0YXRlLmRhbWFnZSArPSAxMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnaGl0RW5kJyxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2hpdC0yJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdXG4gICAgfTtcblxuICAgIGFuaW1hdGlvbnNMb29wLnB1c2goKHRpbWUpID0+IHtcbiAgICAgICAgbGV0IG5leHRQb3NpdGlvbnNYID0gcGh5c2ljcyhcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucG9zaXRpb25YLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFgsXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNwZWVkWCxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uLFxuICAgICAgICAgICAgYXJlbmEueE1heCxcbiAgICAgICAgICAgIGFyZW5hLnhNaW4pO1xuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmRhbWFnZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucnVuQWN0aW9uKCdkYW1hZ2UnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmhlYWx0aCA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmhlYWx0aCA9IDA7XG4gICAgICAgICAgICBlbGVtVWlIZWFsdGguc3R5bGUuY29sb3IgPSAnIzIyMic7XG4gICAgICAgICAgICB0aGlzLnNldFBvc2UoJ2RlYWQnKTtcbiAgICAgICAgICAgIGVsZW1VaS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2RlYWQnKTtcbiAgICAgICAgICAgICBlbGVtVWkuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaGVhbHRoID4gMCAmJiB0aGlzLnN0YXRlLmhlYWx0aCA8PSAzMCkge1xuICAgICAgICAgICAgZWxlbVVpSGVhbHRoLnN0eWxlLmNvbG9yID0gJyNmMDAnO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3RhdGUuaGVhbHRoID4gMzAgJiYgIHRoaXMuc3RhdGUuaGVhbHRoIDw9IDYwKSB7XG4gICAgICAgICAgICBlbGVtVWlIZWFsdGguc3R5bGUuY29sb3IgPSAnI2ZmMCc7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZS5oZWFsdGggPiA2MCkge1xuICAgICAgICAgICAgZWxlbVVpSGVhbHRoLnN0eWxlLmNvbG9yID0gJyMwZjAnO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zdGF0ZS5wb3NpdGlvblggPSBuZXh0UG9zaXRpb25zWC5wb3NpdGlvbjtcbiAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFggPSBuZXh0UG9zaXRpb25zWC5ib29zdDtcbiAgICAgICAgdGhpcy5zdGF0ZS5zcGVlZFggPSBuZXh0UG9zaXRpb25zWC5zcGVlZDtcbiAgICAgICAgdGhpcy5zdGF0ZS5kaXJlY3Rpb24gPSBuZXh0UG9zaXRpb25zWC5kaXJlY3Rpb247XG5cbiAgICAgICAgbGV0IG5leHRQb3NpdGlvbnNZID0gcGh5c2ljcyhcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucG9zaXRpb25ZLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5ib29zdFksXG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNwZWVkWSxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uWSxcbiAgICAgICAgICAgIGFyZW5hLnlNYXgsXG4gICAgICAgICAgICBhcmVuYS55TWluKTtcblxuICAgICAgICB0aGlzLnN0YXRlLnBvc2l0aW9uWSA9IG5leHRQb3NpdGlvbnNZLnBvc2l0aW9uO1xuICAgICAgICB0aGlzLnN0YXRlLmJvb3N0WSA9IG5leHRQb3NpdGlvbnNZLmJvb3N0O1xuICAgICAgICB0aGlzLnN0YXRlLnNwZWVkWSA9IG5leHRQb3NpdGlvbnNZLnNwZWVkO1xuICAgICAgICB0aGlzLnN0YXRlLmRpcmVjdGlvblkgPSBuZXh0UG9zaXRpb25zWS5kaXJlY3Rpb247XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc3BlZWRZID09PSAwICYmIHRoaXMuc3RhdGUucG9zaXRpb25ZID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5kaXJlY3Rpb25ZID0gLTE7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5kaXJlY3Rpb25ZID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5zcGVlZFkgKz0gMztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnBvc2l0aW9uWSA8PSAwICYmIHRoaXMuc3RhdGUuc3BlZWRZIDwgODApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuYm9vc3RZID0gMDtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuc3BlZWRZID0gMDtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUucG9zaXRpb25ZID0gMDtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZGlyZWN0aW9uWSA9IDE7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5wb3NlID09PSAnanVtcCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFBvc2UoJ2xhbmRlZCcpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVuc2V0UG9zZSgnbGFuZGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5zZXRQb3NlKCdqdW1wJyk7XG4gICAgICAgICAgICAgICAgfSwzMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc3BlZWRZID4gMCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnBvc2UpIHRoaXMuc2V0UG9zZSgnanVtcCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy51bnNldFBvc2UoJ2p1bXAnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsZW1IZXJvLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt0aGlzLnN0YXRlLnBvc2l0aW9uWH0lLCAkey10aGlzLnN0YXRlLnBvc2l0aW9uWX0lKWA7XG4gICAgICAgIGVsZW1EaXJlY3Rpb24uc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlWCgke3RoaXMuc3RhdGUuZGlyZWN0aW9ufSlgO1xuICAgICAgICBlbGVtVWlIZWFsdGguaW5uZXJUZXh0ID0gdGhpcy5zdGF0ZS5oZWFsdGg7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbn1cbiIsImZ1bmN0aW9uIHBoeXNpY3MocG9zaXRpb24sIGJvb3N0LCBzcGVlZCwgZGlyZWN0aW9uLCBwb3NNYXgsIHBvc01pbikge1xuICAgIHNwZWVkID0gTWF0aC5hYnMoc3BlZWQpIDwgMSA/IDAgOiBzcGVlZDtcbiAgICBib29zdCA9IGJvb3N0IDw9IDAgPyAwIDogYm9vc3Q7XG5cbiAgICBpZiAoYm9vc3QgPiAwKSB7XG4gICAgICAgIGJvb3N0IC09IDEgKyAoTWF0aC5hYnMoYm9vc3QpIC8gMTAwKTtcbiAgICAgICAgc3BlZWQgKz0gMSArIChNYXRoLmFicyhib29zdCkgLyAxMDApO1xuICAgIH1cbiAgICBlbHNlIGlmIChzcGVlZCAhPT0gMCAmJiBzcGVlZCA+IDApIHtcbiAgICAgICAgc3BlZWQgLT0gMSArIChNYXRoLmFicyhzcGVlZCkgLyAxMDApO1xuICAgIH0gZWxzZSBpZiAoc3BlZWQgIT09IDAgJiYgc3BlZWQgPCAwKSB7XG4gICAgICAgIHNwZWVkICs9IDEgKyAoTWF0aC5hYnMoc3BlZWQpIC8gMTAwKTtcbiAgICB9XG5cbiAgICBwb3NpdGlvbiA9IHBvc2l0aW9uICsgc3BlZWQgLyAxMCAqIGRpcmVjdGlvbjtcblxuICAgIGlmIChwb3NpdGlvbiA+IHBvc01heCkge1xuICAgICAgICBkaXJlY3Rpb24gPSBzcGVlZCA+IDAgPyAtMSA6IDE7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA8IHBvc01pbikge1xuICAgICAgICBkaXJlY3Rpb24gPSBzcGVlZCA+IDAgPyAxIDogLTE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICBib29zdCA6IGJvb3N0LFxuICAgICAgICBzcGVlZCA6IHNwZWVkLFxuICAgICAgICBkaXJlY3Rpb24gOiBkaXJlY3Rpb25cbiAgICB9XG59O1xuIiwiZnVuY3Rpb24gVWkgKCkge1xuICAgIGxldCBjaGFyQ291bnRlciA9IDA7XG4gICAgbGV0IGZvdW5kID0gLTE7XG5cbiAgICB0aGlzLmVsZW1lbnRzID0gW107XG5cbiAgICB0aGlzLm1ha2VQaHJhc2UgPSAobGVuZ3RoKSA9PiB7XG4gICAgICAgIGxldCByZXN1bHQgICAgICAgICAgID0gJyc7XG4gICAgICAgIGxldCBjaGFyYWN0ZXJzICAgICAgID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JztcbiAgICAgICAgLy8gY2hhcmFjdGVycyAgICAgICAgICArPSAn0LDQsdCy0LPQtNC10LbQt9C40LnQutC70LzQvdC+0L/RgNGB0YLRg9GE0YXRhtGH0YjRidGK0YvRjNGN0Y7Rjyc7XG4gICAgICAgIC8vIGNoYXJhY3RlcnMgICAgICAgICAgKz0gJzAxMjM0NTY3ODknO1xuICAgICAgICAvLyBjaGFyYWN0ZXJzICAgICAgICAgICs9ICchQCMkJV4mKigpXytbXXt9XFx8OzpcXCdcIjw+LC4/Lyc7XG5cbiAgICAgICAgbGV0IGNoYXJhY3RlcnNMZW5ndGggICAgID0gY2hhcmFjdGVycy5sZW5ndGg7XG4gICAgICAgIGZvciAoIGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgbGV0IG5ld0NoYXIgPSBjaGFyYWN0ZXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFyYWN0ZXJzTGVuZ3RoKSk7XG4gICAgICAgICAgICBsZXQgc2tpcCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLm1hcCgoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3ltYm9sc1swXSA9PT0gbmV3Q2hhcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2tpcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc2tpcCkgcmVzdWx0ICs9IG5ld0NoYXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgbGV0IGVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnVpX19lbGVtZW50Jyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmVsZW1lbnRzW2ldID0gbmV3IFVpRWxlbWVudChlbGVtc1tpXSk7XG4gICAgICAgIGxldCBsZW5ndGggPSA0O1xuICAgICAgICBpZiAoY29uZmlnLmxlbmd0aFBocmFzZXNGb3JBY3Rpb25zW3RoaXMuZWxlbWVudHNbaV0uYWN0aW9uXSkge1xuICAgICAgICAgICAgbGVuZ3RoID0gY29uZmlnLmxlbmd0aFBocmFzZXNGb3JBY3Rpb25zW3RoaXMuZWxlbWVudHNbaV0uYWN0aW9uXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVsZW1lbnRzW2ldLnNldFRleHQodGhpcy5tYWtlUGhyYXNlKGxlbmd0aCkpO1xuICAgIH1cblxuICAgIGxldCB0aW1lU3RhcnQ7XG4gICAgbGV0IHRpbWVyRm91bmQ7XG5cbiAgICB0aGlzLmZvdW5kID0gKGtleSkgPT4ge1xuICAgICAgICBsZXQgYWN0aW9uUGxheWVkID0gZmFsc2U7XG5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyRm91bmQpO1xuICAgICAgICB0aW1lckZvdW5kID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZvdW5kKGZhbHNlKTtcbiAgICAgICAgfSwgMTIwMCk7XG5cbiAgICAgICAgaWYgKGZvdW5kIDwgMCkge1xuICAgICAgICAgICAgLy8g0J/QvtC40YHQuiDQv9C10YDQstC+0Lkg0LrQu9Cw0LLQuNGI0LhcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMubWFwKCh1aUVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHVpRWxlbWVudC5zeW1ib2xzW2NoYXJDb3VudGVyXSA9PT0ga2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHVpRWxlbWVudC5lbGVtU3ltYm9sc1tjaGFyQ291bnRlcl0uY2xhc3NMaXN0LmFkZCgnZmFkZU91dERvd24nKTtcbiAgICAgICAgICAgICAgICAgICAgdWlFbGVtZW50LmVsZW1UZXh0LnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxLjUpJztcbiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgdGltZVN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdWlFbGVtZW50LmVsZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNoYXJDb3VudGVyKys7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50c1tmb3VuZF0uc3ltYm9sc1tjaGFyQ291bnRlcl0gPT09IGtleSkge1xuICAgICAgICAgICAgLy8g0KHQu9C10LTRg9GO0YnQsNGPINC60LvQsNCy0LjRiNCwINC90LDQttCw0YLQsFxuICAgICAgICAgICAgdGhpcy5lbGVtZW50c1tmb3VuZF0uZWxlbVN5bWJvbHNbY2hhckNvdW50ZXJdLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhZGVJbicpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50c1tmb3VuZF0uZWxlbVN5bWJvbHNbY2hhckNvdW50ZXJdLmNsYXNzTGlzdC5hZGQoJ2ZhZGVPdXREb3duJyk7XG4gICAgICAgICAgICBjaGFyQ291bnRlcisrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gINC+0YjQuNCx0YHRj1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50c1tmb3VuZF0uc2V0VGV4dCh0aGlzLm1ha2VQaHJhc2UodGhpcy5lbGVtZW50c1tmb3VuZF0udGV4dC5sZW5ndGgpKTtcbiAgICAgICAgICAgIGZvdW5kID0gLTE7XG4gICAgICAgICAgICBjaGFyQ291bnRlciA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZm91bmQgPj0gMCAmJiB0aGlzLmVsZW1lbnRzW2ZvdW5kXS5zeW1ib2xzLmxlbmd0aCA9PT0gY2hhckNvdW50ZXIpIHtcbiAgICAgICAgICAgIC8vINCf0L7RgdC70LXQtNC90LjRj9GPINC60LvQsNCy0LjRiNCwLCDQt9Cw0L/Rg9GB0LrQsNC10Lwg0LTQtdC50YHRgtCy0LjQtSwg0L/QtdGA0LXQs9C10L3QtdGA0LjRgNGD0LXQvCDRhNGA0LDQt9GDXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2ZvdW5kXS5zZXRUZXh0KHRoaXMubWFrZVBocmFzZSh0aGlzLmVsZW1lbnRzW2ZvdW5kXS50ZXh0Lmxlbmd0aCkpO1xuICAgICAgICAgICAgZ2FtZU9iamVjdHMucGxheWVyLnJ1bkFjdGlvbih0aGlzLmVsZW1lbnRzW2ZvdW5kXS5hY3Rpb24gLCArdGhpcy5lbGVtZW50c1tmb3VuZF0uZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIHRpbWVTdGFydCA9IDA7XG4gICAgICAgICAgICBmb3VuZCA9IC0xO1xuICAgICAgICAgICAgY2hhckNvdW50ZXIgPSAwO1xuICAgICAgICAgICAgYWN0aW9uUGxheWVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChmb3VuZCA+PSAwICkge1xuICAgICAgICAgICAgLy8g0J3QtSDQv9C+0YHQu9C10LTQvdGP0Y8g0LrQu9Cw0LLQuNGI0LAsINCy0YvQtNC10LvRj9C10Lwg0LXQtSDQutCw0Log0YHQu9C10LTRg9GO0YnRg9GOXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2ZvdW5kXS5lbGVtU3ltYm9sc1tjaGFyQ291bnRlcl0uY2xhc3NMaXN0LmFkZCgndWlfX3N5bWJvbF9zZWxlY3RlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZvdW5kIDwgMCl7XG4gICAgICAgICAgICAvLyDQktC+0LfQstGA0LDRgiDQsiDQuNGB0YXQvtC00L3Rg9GOXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLm1hcCgodWlFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdWlFbGVtZW50LmVsZW0uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgICAgIHVpRWxlbWVudC5lbGVtVGV4dC5zdHlsZS50cmFuc2Zvcm0gPSAnJztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm91bmQgPSAtMTtcbiAgICAgICAgICAgIGNoYXJDb3VudGVyID0gMDtcbiAgICAgICAgICAgIGlmIChhY3Rpb25QbGF5ZWQpIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBVaUVsZW1lbnQgKGVsZW0pIHtcbiAgICAgICAgdGhpcy5lbGVtID0gZWxlbTtcbiAgICAgICAgdGhpcy50ZXh0ID0gJyc7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gZWxlbS5kYXRhc2V0LmFjdGlvbjtcbiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBlbGVtLmRhdGFzZXQuZGlyZWN0aW9uO1xuICAgICAgICB0aGlzLmljb24gPSBlbGVtLmRhdGFzZXQuaWNvbjtcbiAgICAgICAgdGhpcy5zeW1ib2xzID0gW107XG4gICAgICAgIHRoaXMuZWxlbVN5bWJvbHMgPSBbXTtcblxuICAgICAgICB0aGlzLmVsZW1UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuZWxlbVRleHQuY2xhc3NMaXN0LmFkZCgndWlfX3RleHQnKTtcbiAgICAgICAgdGhpcy5lbGVtLmFwcGVuZENoaWxkKHRoaXMuZWxlbVRleHQpO1xuXG4gICAgICAgIHRoaXMuZWxlbVVpSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmVsZW1VaUljb24uY2xhc3NMaXN0LmFkZCgndWlfX2ljb24nKTtcbiAgICAgICAgdGhpcy5lbGVtLmFwcGVuZENoaWxkKHRoaXMuZWxlbVVpSWNvbik7XG5cbiAgICAgICAgdGhpcy5lbGVtSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0aGlzLmVsZW1JY29uLmNsYXNzTGlzdC5hZGQoJ2ljb24nKTtcbiAgICAgICAgdGhpcy5lbGVtSWNvbi5jbGFzc0xpc3QuYWRkKCdpY29uXycgKyB0aGlzLmljb24pO1xuICAgICAgICB0aGlzLmVsZW1VaUljb24uYXBwZW5kQ2hpbGQodGhpcy5lbGVtSWNvbik7XG5cblxuICAgICAgICB0aGlzLnNldFRleHQgPSAodGV4dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgICAgIHRoaXMuZWxlbVRleHQuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAgICAgICAgIGxldCBmYWRlQ2xhc3MgPSAnZmFkZUluJztcbiAgICAgICAgICAgIGxldCBkZWxheSA9IDEwMDtcbiAgICAgICAgICAgIHRoaXMudGV4dC5zcGxpdCgnJykubWFwKChzeW1ib2wsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICAgICAgc3ltYm9sID0gc3ltYm9sID09PSAnICcgPyAnJm5ic3A7JyA6IHN5bWJvbDtcbiAgICAgICAgICAgICAgICB0aGlzLnN5bWJvbHNbaW5kZXhdID0gc3ltYm9sO1xuICAgICAgICAgICAgICAgIHNwYW4uaW5uZXJIVE1MID0gc3ltYm9sO1xuICAgICAgICAgICAgICAgIHNwYW4uY2xhc3NOYW1lID0gJ3VpX19zeW1ib2wgJyArIGZhZGVDbGFzcztcbiAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmFuaW1hdGlvbkRlbGF5ID0gaW5kZXggKiBkZWxheSArICdtcyc7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtU3ltYm9sc1tpbmRleF0gPSBzcGFuO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbVRleHQuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4uY2xhc3NMaXN0LnJlbW92ZShmYWRlQ2xhc3MpO1xuICAgICAgICAgICAgICAgIH0sIChpbmRleCArIDEpICogZGVsYXkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufSIsInZhciBhY3RpdmVEcmF3c0xpc3QgPSBbXTtcbnZhciBzaG93RnJhbWVSYXRlID0gZmFsc2U7XG5cbmZ1bmN0aW9uIGFuaW1hdGUob3B0aW9ucykge1xuICAgIHZhciBvcHRpb25zICA9ICh0eXBlb2Yob3B0aW9ucykgICAgICAgICAgPT0gJ29iamVjdCcpICAgPyBvcHRpb25zICAgICAgICAgIDoge307XG4gICAgdmFyIGR1cmF0aW9uID0gKHR5cGVvZihvcHRpb25zLmR1cmF0aW9uKSA9PSAnbnVtYmVyJykgICA/IG9wdGlvbnMuZHVyYXRpb24gOiAxMDAwO1xuICAgIHZhciBkZWxheSAgICA9ICh0eXBlb2Yob3B0aW9ucy5kZWxheSkgICAgPT0gJ251bWJlcicpICAgPyBvcHRpb25zLmRlbGF5ICAgIDogMDtcbiAgICB2YXIgZnJvbSAgICAgPSAodHlwZW9mKG9wdGlvbnMuZnJvbSkgICAgID09ICdudW1iZXInKSAgID8gb3B0aW9ucy5mcm9tICAgICA6IDE7XG4gICAgdmFyIHRvICAgICAgID0gKHR5cGVvZihvcHRpb25zLnRvKSAgICAgICA9PSAnbnVtYmVyJykgICA/IG9wdGlvbnMudG8gICAgICAgOiAxMDA7XG4gICAgdmFyIHRpbWluZyAgID0gKHR5cGVvZihvcHRpb25zLnRpbWluZykgICA9PSAnZnVuY3Rpb24nKSA/IG9wdGlvbnMudGltaW5nICAgOiBsaW5lYXI7XG4gICAgdmFyIGRyYXcgICAgID0gKHR5cGVvZihvcHRpb25zLmRyYXcpICAgICA9PSAnZnVuY3Rpb24nKSA/IG9wdGlvbnMuZHJhdyAgICAgOiBmdW5jdGlvbihwcm9ncmVzcyl7Y29uc29sZS5sb2cocHJvZ3Jlc3MgKiAxMDApfTtcbiAgICB2YXIgYmVmb3JlICAgPSAodHlwZW9mKG9wdGlvbnMuYmVmb3JlKSAgID09ICdmdW5jdGlvbicpID8gb3B0aW9ucy5iZWZvcmUgICA6IGZ1bmN0aW9uKCkge307XG4gICAgdmFyIGFmdGVyICAgID0gKHR5cGVvZihvcHRpb25zLmFmdGVyKSAgICA9PSAnZnVuY3Rpb24nKSA/IG9wdGlvbnMuYWZ0ZXIgICAgOiBmdW5jdGlvbigpIHt9O1xuXG4gICAgdmFyIGZyYWN0aW9uRnJvbSA9IGZyb20gLyAxMDA7XG4gICAgdmFyIGZyYWN0aW9uVG8gICA9IHRvIC8gMTAwO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ICAgID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgIHZhciB0aW1lTGFzdCA9IHN0YXJ0O1xuXG4gICAgICAgIGZvciAodmFyIGkgPSBhY3RpdmVEcmF3c0xpc3QubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChhY3RpdmVEcmF3c0xpc3RbaV0gPT09IGRyYXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFuaW1hdGlvbkluZGV4ID0gYWN0aXZlRHJhd3NMaXN0LnB1c2goZHJhdyk7XG5cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIGFuaW1hdGUodGltZSkge1xuICAgICAgICAgICAgaWYgKGJlZm9yZSkge1xuICAgICAgICAgICAgICAgIGJlZm9yZSgpO1xuICAgICAgICAgICAgICAgIGJlZm9yZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRpbWVGcmFjdGlvbiA9ICh0aW1lIC0gc3RhcnQpIC8gZHVyYXRpb247XG4gICAgICAgICAgICBpZiAodGltZUZyYWN0aW9uID4gMSkgdGltZUZyYWN0aW9uID0gMTtcblxuICAgICAgICAgICAgaWYgKGZyYWN0aW9uRnJvbSA8IGZyYWN0aW9uVG8pIHtcbiAgICAgICAgICAgICAgICB0aW1lRnJhY3Rpb24gPSB0aW1lRnJhY3Rpb24gKyBmcmFjdGlvbkZyb207XG4gICAgICAgICAgICAgICAgdmFyIHRlcm1pbmF0aW9uQ29uZGl0aW9uID0gdGltZUZyYWN0aW9uIDwgZnJhY3Rpb25UbztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGltZUZyYWN0aW9uID0gLSh0aW1lRnJhY3Rpb24gLSBmcmFjdGlvbkZyb20pO1xuICAgICAgICAgICAgICAgIHZhciB0ZXJtaW5hdGlvbkNvbmRpdGlvbiA9IHRpbWVGcmFjdGlvbiA+IGZyYWN0aW9uVG87XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9IHRpbWluZyh0aW1lRnJhY3Rpb24pO1xuXG4gICAgICAgICAgICBkcmF3KHByb2dyZXNzKTtcblxuICAgICAgICAgICAgaWYgKHRlcm1pbmF0aW9uQ29uZGl0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNob3dGcmFtZVJhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZnJhbWVSYXRlKHRpbWVMYXN0LCB0aW1lKSwgTWF0aC5yb3VuZCh0aW1lRnJhY3Rpb24gKiAxMDApKTtcbiAgICAgICAgICAgICAgICAgICAgdGltZUxhc3QgPSB0aW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlRHJhd3NMaXN0LnNwbGljZShhY3RpdmVEcmF3c0xpc3QuaW5kZXhPZihkcmF3KSwgMSk7XG4gICAgICAgICAgICAgICAgaWYgKGFmdGVyKSBhZnRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LCBkZWxheSk7XG59XG5cbmZ1bmN0aW9uIGZyYW1lUmF0ZSh0aW1lTGFzdCwgdGltZU5vdykge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKDEwMDAgLyAodGltZU5vdyAtIHRpbWVMYXN0KSk7XG59XG5cbmZ1bmN0aW9uIHpvbmUoY3VycmVudCwgZnJvbSwgdG8sIGRyYXcpIHtcbiAgICBjdXJyZW50ID0gY3VycmVudCAqIDEwMDtcbiAgICBmcm9tICAgID0gZnJvbSAqIDEwMDtcbiAgICB0byAgICAgID0gdG8gKiAxMDA7XG4gICAgZHJhdyAgICA9IGRyYXcgKiAxMDA7XG5cbiAgICBpZiAoY3VycmVudCA+PSBmcm9tICYmIGN1cnJlbnQgPD0gdG8pIHtcbiAgICAgICAgdmFyIHByb2dyZXNzID0gKGN1cnJlbnQgLSBmcm9tKSAvICh0byAtIGZyb20pO1xuICAgICAgICBpZiAoZHJhdykgZHJhdyhwcm9ncmVzcyk7XG4gICAgICAgIHJldHVybiBwcm9ncmVzcztcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnQgPD0gZnJvbSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9IGVsc2UgaWYgKGN1cnJlbnQgPj0gdG8pIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxufVxuXG5cbi8vINC/0YDQtdC+0LHRgNCw0LfQvtCy0LDRgtC10LvRjCDQsiBlYXNlT3V0XG5mdW5jdGlvbiBtYWtlRWFzZU91dCh0aW1pbmcpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odGltZUZyYWN0aW9uKSB7XG4gICAgICAgIHJldHVybiAxIC0gdGltaW5nKDEgLSB0aW1lRnJhY3Rpb24pO1xuICAgIH1cbn1cbi8vINC/0YDQtdC+0LHRgNCw0LfQvtCy0LDRgtC10LvRjCDQsiBlYXNlT3V0XG5mdW5jdGlvbiBtYWtlRWFzZUluT3V0KHRpbWluZykge1xuICAgIHJldHVybiBmdW5jdGlvbih0aW1lRnJhY3Rpb24pIHtcbiAgICAgICAgaWYgKHRpbWVGcmFjdGlvbiA8IDAuNSlcbiAgICAgICAgICAgIHJldHVybiB0aW1pbmcoMiAqIHRpbWVGcmFjdGlvbikgLyAyO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gKDIgLSB0aW1pbmcoMiAqICgxIC0gdGltZUZyYWN0aW9uKSkpIC8gMjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGxpbmVhcihwcm9ncmVzcykge1xuICAgIHJldHVybiBwcm9ncmVzcztcbn1cblxuZnVuY3Rpb24gcXVhZChwcm9ncmVzcykge1xuICAgIHJldHVybiBNYXRoLnBvdyhwcm9ncmVzcywgMik7XG59XG52YXIgcXVhZEVhc2VPdXQgPSBtYWtlRWFzZU91dChxdWFkKTtcblxuZnVuY3Rpb24gY2lyYyh0aW1lRnJhY3Rpb24pIHtcbiAgICByZXR1cm4gMSAtIE1hdGguc2luKE1hdGguYWNvcyh0aW1lRnJhY3Rpb24pKVxufVxudmFyIGNpcmNFYXNlT3V0ID0gbWFrZUVhc2VPdXQoY2lyYyk7XG5cbmZ1bmN0aW9uIGJhY2soeCwgdGltZUZyYWN0aW9uKSB7XG4gICAgcmV0dXJuIE1hdGgucG93KHRpbWVGcmFjdGlvbiwgMikgKiAoKHggKyAxKSAqIHRpbWVGcmFjdGlvbiAtIHgpXG59XG52YXIgYmFja0Vhc2VPdXQgPSBtYWtlRWFzZU91dChiYWNrKTtcblxuZnVuY3Rpb24gYm91bmNlKHByb2dyZXNzKSB7XG4gICAgZm9yICh2YXIgYSA9IDAsIGIgPSAxLCByZXN1bHQ7IDE7IGEgKz0gYiwgYiAvPSAyKSB7XG4gICAgICAgIGlmIChwcm9ncmVzcyA+PSAoNyAtIDQgKiBhKSAvIDExKSB7XG4gICAgICAgICAgICByZXR1cm4gLU1hdGgucG93KCgxMSAtIDYgKiBhIC0gMTEgKiBwcm9ncmVzcykgLyA0LCAyKSArIE1hdGgucG93KGIsIDIpO1xuICAgICAgICB9XG4gICAgfVxufVxudmFyIGJvdW5jZUVhc2VPdXQgPSBtYWtlRWFzZU91dChib3VuY2UpO1xuXG5mdW5jdGlvbiBlbGFzdGljKHgsIHRpbWVGcmFjdGlvbikge1xuICAgIHJldHVybiBNYXRoLnBvdygyLCAxMCAqICh0aW1lRnJhY3Rpb24gLSAxKSkgKiBNYXRoLmNvcygyMCAqIE1hdGguUEkgKiB4IC8gMyAqIHRpbWVGcmFjdGlvbilcbn1cbnZhciBlbGFzdGljRWFzZU91dCA9IG1ha2VFYXNlT3V0KGVsYXN0aWMpO1xuIiwiLyoqXG4gKiDQodC+0LrRgNCw0YnQtdC90LjQtSDQtNC70Y8g0LTQvtCx0LDQstC70LXQvdC40Y8g0YHQvtCx0YvRgtC40Y8gRE9NQ29udGVudExvYWRlZFxuICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgQ9C70YPRiNCw0YLQtdC70Ywg0YHQvtCx0YvRgtC40Y9cbiAqL1xuZnVuY3Rpb24gcmVhZHkobGlzdGVuZXIpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBsaXN0ZW5lcik7XG59XG5cbi8qKlxuICogQ3VzdG9tIEV2ZW50IFJlc2l6ZVxuICovXG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRocm90dGxlID0gZnVuY3Rpb24odHlwZSwgbmFtZSwgb2JqKSB7XG4gICAgICAgIG9iaiA9IG9iaiB8fCB3aW5kb3c7XG4gICAgICAgIHZhciBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgIHZhciBmdW5jID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAocnVubmluZykgeyByZXR1cm47IH1cbiAgICAgICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIG9iai5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChuYW1lKSk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGZ1bmMpO1xuICAgIH07XG5cbiAgICAvKiBpbml0IC0geW91IGNhbiBpbml0IGFueSBldmVudCAqL1xuICAgIHRocm90dGxlKFwicmVzaXplXCIsIFwib3B0aW1pemVkUmVzaXplXCIpO1xufSkoKTtcblxuXG4vKipcbiAqINCU0L7QsdCw0LLQu9C10L3QuNC1INGB0L7QsdGL0YLQuNC5XG4gKiBAcGFyYW0ge1t0eXBlXX0gICBvYmplY3QgICBET00g0YPQt9C10LtcbiAqIEBwYXJhbSB7c3RyaW5nfSAgIHR5cGUgICAgINCi0LjQvyDQv9GA0L7RgdC70YPRiNC40LLQsNC10LzQvtCz0L4g0YHQvtCx0YvRgtC40Y8uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBD0LvRg9GI0LDRgtC10LvRjCDRgdC+0LHRi9GC0LjRj1xuICovXG5mdW5jdGlvbiBhZGRFdmVudChvYmplY3QsIHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgaWYgKG9iamVjdCA9PSBudWxsIHx8IHR5cGVvZihvYmplY3QpID09ICd1bmRlZmluZWQnKSByZXR1cm47XG4gICAgaWYgKG9iamVjdC5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICAgIG9iamVjdC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBmYWxzZSk7XG4gICAgfSBlbHNlIGlmIChvYmplY3QuYXR0YWNoRXZlbnQpIHtcbiAgICAgICAgb2JqZWN0LmF0dGFjaEV2ZW50KFwib25cIiArIHR5cGUsIGxpc3RlbmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBvYmplY3RbXCJvblwiICsgdHlwZV0gPSBsaXN0ZW5lcjtcbiAgICB9XG59O1xuXG4vKipcbiAqINGBb21wYXJlRnVuY3Rpb24g0LTQu9GPIGFyci5zb3J0LCDQtNC70Y8g0YHQvtGA0YLQuNGA0L7QutC4INGB0LvRg9GH0LnQvdC+0Lwg0L/QvtGA0Y/QtNC60LVcbiAqL1xuZnVuY3Rpb24gY29tcGFyZVJhbmRvbShhLCBiKSB7XG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgLSAwLjU7XG59XG5cbi8qKlxuICog0J/QvtC70YPRh9C10L3QuNC1IERPTSDQtNC10YDQtdCy0LAg0LTRgNGD0LPQvtC5INGB0YLRgNCw0L3QuNGG0YtcbiAqIEBwYXJhbSAge1N0cmluZ30gICB1cmwgICAgICBVUkwg0YHRgtGA0LDQvdC40YbRi1xuICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrINCf0LXRgNC10LTQsNCy0LDQtdC80LDRjyDRhNGD0L3QutGG0LjRj1xuICovXG5mdW5jdGlvbiBnZXREb2N1bWVudCh1cmwsIGNhbGxiYWNrKVxue1xuICB2YXIgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICBodHRwLm9wZW4oJ0dFVCcsIHVybCk7XG4gIGh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKClcbiAge1xuICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT0gNCAmJiB0aGlzLnN0YXR1cyA9PSAyMDApIHtcbiAgICAgIHZhciBkb2MgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHRoaXMucmVzcG9uc2VUZXh0LCBcInRleHQvaHRtbFwiKTsgIC8vINC/0YDQtdC+0LHRgNCw0LfQvtCy0LDRgtGMINGC0LXQutGB0YIg0LIgSFRNTFxuXG4gICAgICBjYWxsYmFjayhkb2MpO1xuICAgIH1cbiAgfVxuICBodHRwLnNlbmQobnVsbCk7XG59XG5cbi8qKlxuICogINCy0L7Qt9Cy0YDQsNGJ0LDQtdGCIGNvb2tpZSDRgSDQuNC80LXQvdC10LwgbmFtZSwg0LXRgdC70Lgg0LXRgdGC0YwsINC10YHQu9C4INC90LXRgiwg0YLQviB1bmRlZmluZWRcbiAqL1xuZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpIHtcbiAgdmFyIG1hdGNoZXMgPSBkb2N1bWVudC5jb29raWUubWF0Y2gobmV3IFJlZ0V4cChcbiAgICBcIig/Ol58OyApXCIgKyBuYW1lLnJlcGxhY2UoLyhbXFwuJD8qfHt9XFwoXFwpXFxbXFxdXFxcXFxcL1xcK15dKS9nLCAnXFxcXCQxJykgKyBcIj0oW147XSopXCJcbiAgKSk7XG4gIHJldHVybiBtYXRjaGVzID8gZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoZXNbMV0pIDogdW5kZWZpbmVkO1xufVxuIiwidmFyIGJyZWFrcG9pbnQgPSB7XG4gICAgJ3NtYWxsJzogNzY3LFxuICAgICdtZWRpdW0nOiA5OTIsXG4gICAgJ2xhcmdlJzogMTIwMFxufTtcblxuZnVuY3Rpb24gcmVzcG9uZFRvKGJyZWFrcG9pbnQsIGNhbGxiYWNrLCBydW5XaGVuQ2FsbGVkLCBhZGRFdmVudCkge1xuICAgIGlmIChicmVha3BvaW50ID49IHdpbmRvdy5pbm5lcldpZHRoKSB7XG4gICAgICAgIHZhciBhY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZiAocnVuV2hlbkNhbGxlZCkge1xuICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBhY3RpdmUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoYWRkRXZlbnQpIHtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvcHRpbWl6ZWRSZXNpemVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGJyZWFrcG9pbnQgPj0gd2luZG93LmlubmVyV2lkdGgpIHtcblxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYnJlYWtwb2ludCA8PSB3aW5kb3cuaW5uZXJXaWR0aCkgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVzcG9uZEZyb20oYnJlYWtwb2ludCwgY2FsbGJhY2ssIHJ1bldoZW5DYWxsZWQsIGFkZEV2ZW50KSB7XG4gICAgaWYgKGJyZWFrcG9pbnQgPD0gd2luZG93LmlubmVyV2lkdGgpIHtcbiAgICAgICAgdmFyIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmIChydW5XaGVuQ2FsbGVkKSB7XG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChhZGRFdmVudCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9wdGltaXplZFJlc2l6ZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoYnJlYWtwb2ludCA8PSB3aW5kb3cuaW5uZXJXaWR0aCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChicmVha3BvaW50ID49IHdpbmRvdy5pbm5lcldpZHRoKSBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl19
